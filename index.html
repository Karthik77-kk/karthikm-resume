<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0a0a0a">
    <title>Karthik M | Software Developer | Portfolio</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Karthik M - Software Developer at Eurofins IT Solutions. 3+ years experience in .NET Full Stack development at Accenture. Expert in C#, ASP.NET Core, Angular, SQL Server, and Azure.">
    <meta name="keywords" content="Karthik M, Software Developer, .NET Developer, Full Stack Developer, C#, ASP.NET Core, Angular, SQL Server, Azure, Eurofins, Accenture, Bangalore, India, Portfolio">
    <meta name="author" content="Karthik M">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://karthik77-kk.github.io/karthikm-resume/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://karthik77-kk.github.io/karthikm-resume/">
    <meta property="og:title" content="Karthik M | Software Developer">
    <meta property="og:description" content="Software Developer at Eurofins IT Solutions. 3+ years .NET Full Stack experience. Expert in C#, ASP.NET Core, Angular, and Azure.">
    <meta property="og:image" content="https://karthik77-kk.github.io/karthikm-resume/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Karthik M Portfolio">
    <meta property="og:locale" content="en_IN">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://karthik77-kk.github.io/karthikm-resume/">
    <meta name="twitter:title" content="Karthik M | Software Developer">
    <meta name="twitter:description" content="Software Developer at Eurofins. 3+ years .NET experience. Expert in C#, ASP.NET, Azure!">
    <meta name="twitter:image" content="https://karthik77-kk.github.io/karthikm-resume/og-image.png">
    
    <!-- Favicon & Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚀</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🚀</text></svg>">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="KM Portfolio">
    
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- New Features CSS -->
    <link rel="stylesheet" href="assets/css/new-features.css">
    
    <!-- AI Chatbot & Immersive Effects CSS -->
    <link rel="stylesheet" href="assets/css/ai-chatbot.css">
    <link rel="stylesheet" href="assets/css/immersive-effects.css">
    <link rel="stylesheet" href="assets/css/advanced-features.css">
    <link rel="stylesheet" href="assets/css/ultra-advanced.css">
    <link rel="stylesheet" href="assets/css/futuristic-enhancements.css">
    <link rel="stylesheet" href="assets/css/mega-features.css">
    
    <!-- Responsive Design - Must be last to override -->
    <link rel="stylesheet" href="assets/css/responsive-design.css">
    
    <!-- Security Headers (hints for server configuration) -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <!-- Preconnect for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    
    <!-- Google Fonts with fallback -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
    </noscript>
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "Karthik M",
        "jobTitle": "Software Developer",
        "worksFor": {
            "@type": "Organization",
            "name": "Eurofins IT Solutions India Pvt Ltd"
        },
        "url": "https://karthik77-kk.github.io/karthikm-resume/",
        "email": "iammrkarthik2002@gmail.com",
        "telephone": "+917019880061",
        "address": {
            "@type": "PostalAddress",
            "addressLocality": "Bangalore",
            "addressCountry": "India"
        },
        "sameAs": [
            "https://linkedin.com/in/karthik-m-9262a02b4",
            "https://github.com/Karthik77-kk"
        ],
        "knowsAbout": ["C#", ".NET Core", "ASP.NET MVC", "Angular", "SQL Server", "Azure", "Entity Framework", "REST APIs"],
        "alumniOf": [
            {
                "@type": "EducationalOrganization",
                "name": "RNS First Grade College, Bangalore University"
            }
        ]
    }
    </script>
    
    <!-- 
        GOOGLE ANALYTICS 4 SETUP (Optional but Recommended):
        1. Visit https://analytics.google.com
        2. Create a new GA4 property
        3. Get your Measurement ID (format: G-XXXXXXXXXX)
        4. Uncomment the script below and replace YOUR_MEASUREMENT_ID
    -->
    <!-- 
    <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_MEASUREMENT_ID"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'YOUR_MEASUREMENT_ID', {
        'anonymize_ip': true,
        'cookie_flags': 'SameSite=None;Secure',
        'page_title': 'Karthik M Portfolio',
        'custom_map': {
          'dimension1': 'user_level',
          'dimension2': 'game_mode'
        }
      });
    </script>
    -->
    
    <style>
        /* ==================== ULTRA CSS - COMPLETE TRANSFORMATION ==================== */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #00ffff;
            --secondary: #ff00ff;
            --accent: #ffff00;
            --success: #00ff88;
            --danger: #ff4444;
            --warning: #ffaa00;
            --dark: #0a0a0a;
            --darker: #050505;
            --glass: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glow: 0 0 20px var(--primary), 0 0 40px var(--primary);
            --text-primary: #ffffff;
            --text-secondary: #cccccc;
            --text-muted: #888888;
            --bg-card: rgba(10, 10, 10, 0.7);
            --border-color: rgba(0, 255, 255, 0.2);
            --font-display: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', 'Segoe UI', sans-serif;
        }

        /* ==================== CUSTOM CURSOR (DISABLED) ==================== */
        /* Custom cursor removed for performance */
        .custom-cursor, .cursor-dot, .cursor-trail {
            display: none !important;
        }

        /* ==================== QR CODE MODAL ==================== */
        .qr-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000001;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .qr-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .qr-modal-backdrop {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }
        
        .qr-modal-content {
            position: relative;
            background: rgba(10, 10, 10, 0.95);
            border: 2px solid var(--primary);
            border-radius: 20px;
            padding: 2rem;
            max-width: 400px;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }
        
        .qr-modal.show .qr-modal-content {
            transform: scale(1);
        }
        
        .qr-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .qr-modal-close:hover {
            color: var(--primary);
        }
        
        .qr-code-container {
            display: flex;
            justify-content: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
        }
        
        .qr-code-container canvas {
            max-width: 200px;
        }

        /* ==================== GITHUB STATS ==================== */
        .github-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .github-stat-card {
            background: rgba(13, 17, 23, 0.8);
            border: 1px solid var(--primary);
            border-radius: 15px;
            padding: 1rem;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .github-stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }

        /* ==================== XP & GAMIFICATION SYSTEM ==================== */
        .xp-bar-container {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: rgba(0, 255, 255, 0.1);
            z-index: 100000;
        }

        .xp-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px var(--primary);
        }

        .xp-display {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 0.4rem 1.2rem;
            border-radius: 25px;
            border: 1px solid var(--primary);
            font-family: var(--font-display);
            font-size: 0.75rem;
            z-index: 99999;
            display: flex;
            align-items: center;
            gap: 1rem;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .xp-display.visible { opacity: 1; }

        .xp-level {
            color: var(--accent);
            font-weight: 700;
        }

        .xp-points {
            color: var(--primary);
        }

        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.98), rgba(20, 20, 20, 0.98));
            border: 3px solid var(--accent);
            border-radius: 25px;
            padding: 2.5rem 3rem;
            z-index: 1000000;
            text-align: center;
            box-shadow: 0 0 100px rgba(255, 255, 0, 0.5);
            transition: transform 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55), top 0.3s, left 0.3s;
            cursor: pointer;
        }

        .achievement-popup.show {
            transform: translate(-50%, -50%) scale(1);
        }

        /* Game mode: Show achievement in corner to not block gameplay */
        .achievement-popup.game-mode {
            top: 15%;
            left: auto;
            right: 1rem;
            transform: translateX(120%) scale(0.8);
            padding: 1rem 1.5rem;
            border-width: 2px;
            box-shadow: 0 0 30px rgba(255, 255, 0, 0.3);
        }

        .achievement-popup.game-mode.show {
            transform: translateX(0) scale(0.8);
        }

        .achievement-popup.game-mode .badge-icon {
            font-size: 2.5rem;
            margin: 0.5rem 0;
        }

        .achievement-popup.game-mode h3 {
            font-size: 0.9rem;
        }

        .achievement-popup.game-mode .badge-name {
            font-size: 0.9rem;
        }

        .achievement-popup.game-mode .xp-reward {
            font-size: 0.8rem;
        }

        .achievement-popup h3 {
            color: var(--accent);
            font-family: var(--font-display);
            font-size: 1.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 0 20px var(--accent);
        }

        .achievement-popup .badge-icon {
            font-size: 5rem;
            margin: 1rem 0;
            animation: badge-bounce 0.6s ease;
        }

        @keyframes badge-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .achievement-popup .badge-name {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-family: var(--font-body);
        }

        .achievement-popup .xp-reward {
            color: var(--success);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        /* Combo Display */
        .combo-popup {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%) scale(0);
            font-family: var(--font-display);
            font-size: 3rem;
            font-weight: 900;
            color: var(--accent);
            text-shadow: 0 0 30px var(--accent), 0 0 60px var(--accent);
            z-index: 100001;
            pointer-events: none;
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .combo-popup.show {
            transform: translateX(-50%) scale(1);
            animation: combo-shake 0.5s ease;
        }

        @keyframes combo-shake {
            0%, 100% { transform: translateX(-50%) scale(1) rotate(0deg); }
            25% { transform: translateX(-50%) scale(1.1) rotate(-3deg); }
            75% { transform: translateX(-50%) scale(1.1) rotate(3deg); }
        }

        /* Easter Egg Mode */
        .easter-egg-active {
            animation: rainbow-mode 3s linear infinite;
        }

        @keyframes rainbow-mode {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        .easter-egg-text {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--accent);
            text-shadow: 0 0 50px var(--accent);
            z-index: 1000002;
            pointer-events: none;
            white-space: nowrap;
            transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .easter-egg-text.show {
            transform: translate(-50%, -50%) scale(1);
        }

        /* Light Theme */
        [data-theme="light"] {
            --primary: #0088aa;
            --secondary: #cc0088;
            --accent: #cc9900;
            --dark: #f5f5f5;
            --darker: #ffffff;
            --text-primary: #1a1a1a;
            --text-secondary: #444444;
            --text-muted: #666666;
            --bg-card: rgba(255, 255, 255, 0.9);
            --border-color: rgba(0, 136, 170, 0.3);
            --glass: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(0, 0, 0, 0.1);
        }

        [data-theme="light"] body {
            background: var(--darker);
            color: var(--text-primary);
        }

        [data-theme="light"] .space-bg {
            background: linear-gradient(135deg, #e0f7fa 0%, #f5f5f5 100%);
        }

        [data-theme="light"] .stars, 
        [data-theme="light"] .stars2, 
        [data-theme="light"] .stars3,
        [data-theme="light"] .nebula,
        [data-theme="light"] .moon,
        [data-theme="light"] .planet,
        [data-theme="light"] .cosmic-ring {
            opacity: 0.1;
        }

        [data-theme="light"] .custom-cursor,
        [data-theme="light"] .cursor-dot {
            mix-blend-mode: normal;
        }

        /* ==================== GLASSMORPHISM 2.0 ==================== */
        .glass-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
        }

        .glass-card-strong {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        /* Holographic Effect */
        .holographic {
            background: linear-gradient(
                135deg,
                rgba(255, 0, 255, 0.1) 0%,
                rgba(0, 255, 255, 0.1) 25%,
                rgba(255, 255, 0, 0.1) 50%,
                rgba(0, 255, 255, 0.1) 75%,
                rgba(255, 0, 255, 0.1) 100%
            );
            background-size: 400% 400%;
            animation: holographic-shift 8s ease infinite;
        }

        @keyframes holographic-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .holographic:hover {
            animation-duration: 2s;
        }

        /* Neon Flicker Effect */
        .neon-flicker {
            animation: neon-flicker 3s infinite;
        }

        @keyframes neon-flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                text-shadow: 
                    0 0 5px var(--primary),
                    0 0 10px var(--primary),
                    0 0 20px var(--primary),
                    0 0 40px var(--primary);
            }
            20%, 24%, 55% {
                text-shadow: none;
            }
        }

        /* CRT Scanlines Effect */
        .crt-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99997;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.05) 0px,
                rgba(0, 0, 0, 0.05) 1px,
                transparent 1px,
                transparent 2px
            );
            opacity: 0.3;
        }

        /* Skip Navigation Link - Accessibility */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: var(--dark);
            padding: 8px 16px;
            z-index: 100000;
            font-weight: 700;
            text-decoration: none;
            border-radius: 0 0 8px 0;
            transition: top 0.3s;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Focus States for Accessibility */
        *:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        *:focus:not(:focus-visible) {
            outline: none;
        }

        *:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Performance Hints */
        .space-bg,
        .stars,
        .stars2,
        .stars3,
        .nebula,
        .moon,
        .planet,
        .cosmic-ring {
            will-change: transform, opacity;
        }

        /* Print Styles */
        @media print {
            .space-bg, .progress-bar, #gameContainer, .back-to-top, 
            .theme-toggle, .nav-header, .particle, .skip-link {
                display: none !important;
            }
            
            body {
                background: white !important;
                color: black !important;
            }
            
            #portfolio {
                opacity: 1 !important;
            }
            
            section {
                break-inside: avoid;
                background: white !important;
                border: 1px solid #ccc !important;
            }
            
            .hero-title, .section-title, h3, h4 {
                color: black !important;
                -webkit-text-fill-color: black !important;
            }
            
            a {
                color: #0066cc !important;
            }
        }

        /* Reduced Motion - Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
            
            .stars, .stars2, .stars3, .nebula, .moon, .planet, 
            .cosmic-ring, .cursor-trail, .particle {
                display: none !important;
            }
            
            .hero-title, .company-badge, .typewriter {
                animation: none !important;
            }
        }

        /* Navigation Header */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 9998;
            background: rgba(5, 5, 5, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: 0.8rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transform: translateY(-100%);
            transition: transform 0.3s ease;
        }

        .nav-header.visible {
            transform: translateY(0);
        }

        [data-theme="light"] .nav-header {
            background: rgba(255, 255, 255, 0.95);
        }

        .nav-logo {
            font-size: 1.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            list-style: none;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: color 0.3s, transform 0.3s;
            padding: 0.5rem;
        }

        .nav-links a:hover,
        .nav-links a:focus {
            color: var(--primary);
            transform: translateY(-2px);
        }

        .nav-links a.active {
            color: var(--primary);
        }

        .nav-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        /* Theme Toggle Button */
        /* Theme toggle removed */
        .theme-toggle {
            display: none !important;
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 9997;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            background: rgba(0, 0, 0, 0.8);
            color: var(--primary);
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        [data-theme="light"] .back-to-top {
            background: rgba(255, 255, 255, 0.9);
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 0 30px var(--primary);
        }

        /* Skip Game Button */
        .skip-game-btn {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--accent);
            border-radius: 30px;
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 1002;
        }

        .skip-game-btn:hover,
        .skip-game-btn:focus {
            background: var(--accent);
            color: var(--dark);
            box-shadow: 0 0 20px var(--accent);
        }

        /* Loading Progress */
        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(0, 255, 255, 0.2);
            border-radius: 2px;
            margin-top: 1.5rem;
            overflow: hidden;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s;
            border-radius: 2px;
        }

        .loading-percent {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: var(--primary);
        }

        /* Tooltip for Skills */
        .skill-tag {
            position: relative;
        }

        .skill-tag::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            pointer-events: none;
            border: 1px solid var(--primary);
            z-index: 100;
        }

        .skill-tag:hover::after {
            opacity: 1;
            visibility: visible;
            bottom: calc(100% + 10px);
        }

        /* Download Resume Button */
        .download-resume {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--dark);
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
            margin-top: 1.5rem;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
        }

        .download-resume:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.6);
        }

        /* Contact Form */
        .contact-form {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: var(--bg-card);
            border: 2px solid var(--border-color);
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.2);
        }

        .form-group textarea {
            min-height: 150px;
            resize: vertical;
        }

        .form-submit {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--dark);
            border: none;
            border-radius: 10px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .form-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.4);
        }

        .form-error {
            display: block;
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 0.3rem;
            min-height: 1.2rem;
        }

        .form-group input.error,
        .form-group textarea.error {
            border-color: var(--danger);
        }

        .form-group input.success,
        .form-group textarea.success {
            border-color: var(--success);
        }

        /* WhatsApp Button */
        .whatsapp-float {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            z-index: 9996;
            width: 55px;
            height: 55px;
            border-radius: 50%;
            background: #25D366;
            color: white;
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            box-shadow: 0 4px 20px rgba(37, 211, 102, 0.4);
            transition: all 0.3s;
        }

        .whatsapp-float:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 30px rgba(37, 211, 102, 0.6);
        }

        /* Social Links */
        .social-links {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .social-link {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 1.3rem;
            transition: all 0.3s;
        }

        .social-link:hover {
            background: var(--primary);
            transform: translateY(-5px) rotate(10deg);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.4);
        }

        /* Languages Section */
        .languages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            position: relative;
            z-index: 1;
        }

        .language-card {
            padding: 1.5rem;
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid var(--border-color);
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .language-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        }

        .language-card .flag {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .language-card h4 {
            color: var(--primary);
            margin-bottom: 0.3rem;
        }

        .language-card p {
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        /* Hobbies Section */
        .hobbies-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            position: relative;
            z-index: 1;
        }

        .hobby-tag {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.1), rgba(0, 255, 255, 0.1));
            border: 2px solid var(--secondary);
            border-radius: 30px;
            font-size: 1rem;
            transition: all 0.3s;
            cursor: default;
        }

        .hobby-tag:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(255, 0, 255, 0.3);
        }

        .hobby-tag .emoji {
            font-size: 1.3rem;
        }

        /* Game Difficulty Selector */
        .difficulty-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 0.6rem 1.5rem;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .difficulty-btn.active,
        .difficulty-btn:hover {
            background: var(--primary);
            color: var(--dark);
        }

        .difficulty-btn.easy { border-color: #00ff00; color: #00ff00; }
        .difficulty-btn.easy.active, .difficulty-btn.easy:hover { background: #00ff00; color: var(--dark); }
        .difficulty-btn.medium { border-color: #ffaa00; color: #ffaa00; }
        .difficulty-btn.medium.active, .difficulty-btn.medium:hover { background: #ffaa00; color: var(--dark); }
        .difficulty-btn.hard { border-color: #ff0000; color: #ff0000; }
        .difficulty-btn.hard.active, .difficulty-btn.hard:hover { background: #ff0000; color: var(--dark); }

        /* Game Pause Overlay */
        .pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 10;
        }

        .pause-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .pause-overlay h2 {
            font-size: 3rem;
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .pause-overlay p {
            color: var(--text-secondary);
        }

        /* High Score Display */
        .high-score {
            color: var(--accent);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }

        /* Power-up Indicators */
        .power-up-indicator {
            position: absolute;
            top: 80px;
            right: 15px;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .power-up-badge {
            padding: 0.3rem 0.8rem;
            background: rgba(255, 255, 0, 0.2);
            border: 1px solid var(--accent);
            border-radius: 10px;
            font-size: 0.75rem;
            color: var(--accent);
        }

        /* Sound Toggle */
        .sound-toggle {
            position: absolute;
            top: 1rem;
            left: 1rem;
            padding: 0.5rem;
            background: transparent;
            border: 2px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1002;
            font-size: 1.2rem;
        }

        .sound-toggle:hover {
            background: rgba(0, 255, 255, 0.2);
        }

        /* Section Active Indicator */
        .section-indicator {
            position: fixed;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 9995;
            display: none;
        }

        .section-indicator.visible {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .section-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(0, 255, 255, 0.3);
            border: 2px solid var(--primary);
            cursor: pointer;
            transition: all 0.3s;
        }

        .section-dot.active {
            background: var(--primary);
            transform: scale(1.3);
        }

        .section-dot:hover {
            transform: scale(1.2);
        }

        /* Version Footer */
        .version-info {
            margin-top: 1rem;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Responsive Navigation */
        @media (max-width: 768px) {
            .nav-header {
                padding: 0.5rem 1rem;
            }
            
            .nav-links {
                display: none;
            }
            
            .nav-links.mobile-open {
                display: flex;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(5, 5, 5, 0.98);
                flex-direction: column;
                padding: 1rem;
                gap: 1rem;
            }
            
            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                color: var(--primary);
                font-size: 1.5rem;
                cursor: pointer;
            }
            
            .theme-toggle {
                top: auto;
                bottom: 10rem;
            }
            
            .section-indicator {
                display: none !important;
            }
        }

        @media (min-width: 769px) {
            .mobile-menu-btn {
                display: none;
            }
        }

        body {
            font-family: var(--font-body);
            background: var(--darker);
            color: #fff;
            overflow-x: hidden;
            touch-action: pan-y;
            cursor: auto;
        }

        /* ==================== ENHANCED LOADING SCREEN ==================== */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000000;
            transition: opacity 0.8s, visibility 0.8s;
        }

        #loadingScreen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-container {
            position: relative;
            width: 150px;
            height: 150px;
        }

        .loader-ring {
            position: absolute;
            inset: 0;
            border: 4px solid transparent;
            border-radius: 50%;
        }

        .loader-ring:nth-child(1) {
            border-top-color: var(--primary);
            animation: spin 1.5s linear infinite;
        }

        .loader-ring:nth-child(2) {
            inset: 15px;
            border-right-color: var(--secondary);
            animation: spin 2s linear infinite reverse;
        }

        .loader-ring:nth-child(3) {
            inset: 30px;
            border-bottom-color: var(--accent);
            animation: spin 2.5s linear infinite;
        }

        .loader-ring:nth-child(4) {
            inset: 45px;
            border-left-color: var(--success);
            animation: spin 3s linear infinite reverse;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader-text {
            margin-top: 2rem;
            font-family: var(--font-display);
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: var(--primary);
            letter-spacing: 3px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .loader {
            width: 100px;
            height: 100px;
            border: 5px solid rgba(0, 255, 255, 0.1);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .loading-text {
            margin-top: 2rem;
            font-family: var(--font-display);
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: var(--primary);
            letter-spacing: 3px;
            animation: pulse 1.5s ease-in-out infinite;
        }

        .loading-progress {
            width: 280px;
            height: 6px;
            background: rgba(0, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 2rem;
            overflow: hidden;
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent), var(--primary));
            background-size: 300% 100%;
            width: 0%;
            border-radius: 3px;
            animation: gradient-flow 2s linear infinite;
            transition: width 0.3s;
        }

        @keyframes gradient-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }

        .loading-percent {
            margin-top: 1rem;
            font-family: var(--font-display);
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-tips {
            margin-top: 2rem;
            font-size: 0.85rem;
            color: var(--text-muted);
            text-align: center;
            max-width: 300px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Animated Space Background */
        .space-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            overflow: hidden;
        }

        /* Stars Layers with Parallax */
        .stars, .stars2, .stars3 {
            position: absolute;
            top: 0;
            left: 0;
            width: 200%;
            height: 200%;
            background: transparent;
            transition: transform 0.1s ease-out;
        }

        /* Parallax movement on scroll */
        .parallax-enabled .stars {
            transform: translateY(calc(var(--scroll-y, 0) * 0.1px));
        }

        .parallax-enabled .stars2 {
            transform: translateY(calc(var(--scroll-y, 0) * 0.05px));
        }

        .parallax-enabled .stars3 {
            transform: translateY(calc(var(--scroll-y, 0) * 0.02px));
        }

        .parallax-enabled .moon {
            transform: translateY(calc(var(--scroll-y, 0) * -0.15px));
        }

        .parallax-enabled .planet-1 {
            transform: translateY(calc(var(--scroll-y, 0) * 0.08px));
        }

        .parallax-enabled .planet-2 {
            transform: translateY(calc(var(--scroll-y, 0) * -0.05px));
        }

        .stars {
            background-image: 
                radial-gradient(2px 2px at 20% 30%, white, transparent),
                radial-gradient(2px 2px at 60% 70%, white, transparent),
                radial-gradient(1px 1px at 50% 50%, white, transparent),
                radial-gradient(1px 1px at 80% 10%, white, transparent),
                radial-gradient(2px 2px at 90% 60%, white, transparent),
                radial-gradient(1px 1px at 15% 80%, white, transparent),
                radial-gradient(2px 2px at 35% 45%, white, transparent);
            background-size: 200px 200px;
            animation: stars-move 120s linear infinite;
        }

        .stars2 {
            background-image: 
                radial-gradient(1px 1px at 30% 60%, white, transparent),
                radial-gradient(1px 1px at 70% 20%, white, transparent),
                radial-gradient(1px 1px at 40% 80%, white, transparent),
                radial-gradient(2px 2px at 85% 50%, white, transparent);
            background-size: 300px 300px;
            animation: stars-move 180s linear infinite;
        }

        .stars3 {
            background-image: 
                radial-gradient(3px 3px at 10% 40%, #00ffff, transparent),
                radial-gradient(2px 2px at 90% 80%, #ff00ff, transparent),
                radial-gradient(2px 2px at 50% 10%, #ffff00, transparent),
                radial-gradient(3px 3px at 25% 65%, #00ffff, transparent);
            background-size: 400px 400px;
            animation: stars-move 240s linear infinite;
        }

        @keyframes stars-move {
            from { transform: translateY(0); }
            to { transform: translateY(-1000px); }
        }

        /* Shooting Stars */
        .shooting-star {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, #fff, transparent);
            animation: shoot 3s ease-out infinite;
            box-shadow: 0 0 10px #fff;
        }

        @keyframes shoot {
            0% {
                transform: translateX(0) translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateX(300px) translateY(300px);
                opacity: 0;
            }
        }

        /* Moon */
        .moon {
            position: fixed;
            top: 10%;
            right: 10%;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #fff, #ddd);
            box-shadow: 0 0 60px rgba(255, 255, 255, 0.8), 
                        inset -10px -10px 20px rgba(0, 0, 0, 0.2);
            animation: moon-float 8s ease-in-out infinite;
            z-index: 1;
        }

        .moon::before {
            content: '';
            position: absolute;
            top: 20%;
            left: 25%;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.1);
            box-shadow: 25px 15px 0 -3px rgba(0, 0, 0, 0.1),
                        -5px 25px 0 -2px rgba(0, 0, 0, 0.1);
        }

        @keyframes moon-float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-30px) rotate(5deg); }
        }

        /* Nebula Effect */
        .nebula {
            position: fixed;
            width: 100%;
            height: 100%;
            opacity: 0.3;
            mix-blend-mode: screen;
            animation: nebula-pulse 15s ease-in-out infinite;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 0, 255, 0.3), transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(0, 255, 255, 0.3), transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 255, 0, 0.2), transparent 50%);
        }

        @keyframes nebula-pulse {
            0%, 100% { opacity: 0.2; transform: scale(1) rotate(0deg); }
            50% { opacity: 0.4; transform: scale(1.1) rotate(5deg); }
        }

        /* Floating Planets */
        .planet {
            position: fixed;
            border-radius: 50%;
            animation: planet-orbit 20s linear infinite;
        }

        .planet-1 {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle at 30% 30%, #ff6b6b, #c92a2a);
            box-shadow: 0 0 40px rgba(255, 107, 107, 0.6);
            top: 20%;
            left: 5%;
        }

        .planet-2 {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle at 30% 30%, #4dabf7, #1971c2);
            box-shadow: 0 0 50px rgba(77, 171, 247, 0.6);
            bottom: 15%;
            right: 8%;
            animation-duration: 25s;
        }

        @keyframes planet-orbit {
            0%, 100% { transform: translateY(0) translateX(0) scale(1); }
            25% { transform: translateY(-20px) translateX(15px) scale(1.1); }
            50% { transform: translateY(-10px) translateX(-15px) scale(0.9); }
            75% { transform: translateY(20px) translateX(10px) scale(1.05); }
        }

        /* Game Container */
        #gameContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            background: rgba(0, 0, 0, 0.98);
            transition: opacity 0.8s, visibility 0.8s;
            padding: 1rem;
        }

        #gameContainer.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .game-title {
            font-family: var(--font-display);
            font-size: clamp(1.5rem, 5vw, 3.5rem);
            text-align: center;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent));
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 3s ease infinite, title-glow 2s ease-in-out infinite;
        }

        @keyframes title-glow {
            0%, 100% { filter: brightness(1) drop-shadow(0 0 20px var(--primary)); }
            50% { filter: brightness(1.3) drop-shadow(0 0 40px var(--primary)); }
        }

        /* Game Mode Selector */
        .game-modes {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .mode-btn {
            padding: 0.5rem 1.2rem;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 25px;
            font-family: var(--font-display);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .mode-btn.active, .mode-btn:hover {
            background: var(--primary);
            color: var(--dark);
            box-shadow: 0 0 20px var(--primary);
        }

        /* Difficulty Selector Enhanced */
        .difficulty-selector {
            display: flex;
            gap: 0.8rem;
            margin-bottom: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 0.5rem 1.2rem;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 20px;
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .difficulty-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: currentColor;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.4s, height 0.4s;
            opacity: 0.3;
        }

        .difficulty-btn:hover::before {
            width: 200px;
            height: 200px;
        }

        .difficulty-btn.active,
        .difficulty-btn:hover {
            background: var(--primary);
            color: var(--dark);
        }

        .difficulty-btn.easy { border-color: #00ff00; color: #00ff00; }
        .difficulty-btn.easy.active, .difficulty-btn.easy:hover { background: #00ff00; color: var(--dark); }
        .difficulty-btn.medium { border-color: #ffaa00; color: #ffaa00; }
        .difficulty-btn.medium.active, .difficulty-btn.medium:hover { background: #ffaa00; color: var(--dark); }
        .difficulty-btn.hard { border-color: #ff0000; color: #ff0000; }
        .difficulty-btn.hard.active, .difficulty-btn.hard:hover { background: #ff0000; color: var(--dark); }

        /* Weapon Selector */
        .weapon-selector {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.8rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .weapon-btn {
            padding: 0.4rem 1rem;
            border: 2px solid var(--secondary);
            background: transparent;
            color: var(--secondary);
            border-radius: 15px;
            font-family: var(--font-body);
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .weapon-btn.active {
            background: var(--secondary);
            color: var(--dark);
            box-shadow: 0 0 15px var(--secondary);
        }

        .weapon-btn.locked {
            opacity: 0.4;
            cursor: not-allowed;
            border-style: dashed;
        }

        .weapon-btn:not(.locked):hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.3);
        }

        /* Game Canvas Enhanced */
        .game-wrapper {
            position: relative;
            display: inline-block;
        }

        canvas {
            border: 3px solid var(--primary);
            border-radius: 15px;
            box-shadow: 
                0 0 30px rgba(0, 255, 255, 0.3),
                inset 0 0 30px rgba(0, 255, 255, 0.05);
            max-width: 95vw;
            max-height: 55vh;
            touch-action: none;
            cursor: crosshair;
        }

        /* Boss Warning */
        .boss-warning {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: var(--font-display);
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 900;
            color: var(--danger);
            text-shadow: 0 0 30px var(--danger);
            opacity: 0;
            pointer-events: none;
            z-index: 10;
            white-space: nowrap;
        }

        .boss-warning.show {
            animation: boss-flash 0.5s ease-in-out 4;
        }

        @keyframes boss-flash {
            0%, 100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        }

        /* Combo Display In-Game */
        .game-combo {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translateX(-50%) scale(0);
            font-family: var(--font-display);
            font-size: 2rem;
            font-weight: 900;
            color: var(--accent);
            text-shadow: 0 0 20px var(--accent);
            pointer-events: none;
            z-index: 10;
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .game-combo.show {
            transform: translateX(-50%) scale(1);
        }

        /* Screen Shake Class */
        .screen-shake {
            animation: shake 0.3s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-1deg); }
            75% { transform: translateX(5px) rotate(1deg); }
        }

        /* Game Pause Overlay */
        .pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            z-index: 15;
            border-radius: 15px;
        }

        .pause-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .pause-overlay h2 {
            font-family: var(--font-display);
            font-size: 3rem;
            color: var(--accent);
            text-shadow: 0 0 30px var(--accent);
        }

        .pause-overlay p {
            color: var(--text-secondary);
            margin-top: 1rem;
        }

        .game-instructions {
            margin-top: 1rem;
            text-align: center;
            font-size: clamp(0.75rem, 2vw, 1rem);
            color: var(--primary);
            font-family: var(--font-body);
            animation: blink 1.5s infinite;
            padding: 0 1rem;
        }

        .game-stats {
            display: flex;
            gap: 2rem;
            margin-top: 0.5rem;
            font-family: var(--font-display);
            font-size: 0.85rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .game-stats span {
            color: var(--accent);
        }

        .high-score {
            color: var(--accent);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            font-family: var(--font-display);
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        .touch-controls {
            display: none;
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            gap: 1rem;
            z-index: 1001;
        }

        .touch-btn {
            width: 60px;
            height: 60px;
            background: rgba(0, 255, 255, 0.2);
            border: 2px solid var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary);
            touch-action: manipulation;
            user-select: none;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }

        .touch-btn:active {
            background: rgba(0, 255, 255, 0.4);
            transform: scale(0.95);
        }

        @media (max-width: 768px), (pointer: coarse) {
            .touch-controls {
                display: flex;
            }
        }

        /* Portfolio Content */
        #portfolio {
            opacity: 0;
            transition: opacity 1s;
            padding: 2rem 1rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        #portfolio.visible {
            opacity: 1;
        }

        /* Header */
        header {
            text-align: center;
            padding: 4rem 2rem;
            position: relative;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .hero-title {
            font-family: var(--font-display);
            font-size: clamp(3rem, 12vw, 8rem);
            font-weight: 900;
            background: linear-gradient(135deg, #00ffff 0%, #ff00ff 50%, #ffff00 100%);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-shift 5s ease infinite, hero-float 4s ease-in-out infinite;
            letter-spacing: -3px;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .hero-title::after {
            content: 'KARTHIK M';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.3), rgba(255, 0, 255, 0.3));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: blur(30px);
            z-index: -1;
        }

        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        @keyframes hero-float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .hero-subtitle {
            font-family: var(--font-display);
            font-size: clamp(0.9rem, 2.5vw, 1.5rem);
            color: var(--primary);
            margin-bottom: 1rem;
            letter-spacing: 3px;
            position: relative;
        }

        .typewriter {
            display: inline-block;
            border-right: 3px solid var(--primary);
            padding-right: 5px;
            animation: blink-caret 0.75s step-end infinite;
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: var(--primary); }
        }

        .hero-tagline {
            font-size: clamp(0.9rem, 2vw, 1.2rem);
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto 2rem;
            line-height: 1.8;
        }

        .company-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem 2rem;
            margin: 1rem 0;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.1), rgba(255, 0, 255, 0.1));
            border: 2px solid var(--primary);
            border-radius: 50px;
            font-family: var(--font-display);
            font-size: clamp(0.85rem, 2vw, 1.1rem);
            font-weight: 700;
            color: var(--primary);
            animation: badge-glow 2s ease-in-out infinite;
            backdrop-filter: blur(10px);
        }

        @keyframes badge-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 255, 0.3); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 255, 0.6), 0 0 60px rgba(255, 0, 255, 0.3); }
        }

        /* Hero Buttons */
        .hero-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin: 1.5rem 0;
        }

        .btn {
            padding: 1rem 2rem;
            border-radius: 50px;
            font-family: var(--font-display);
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--dark);
            border: none;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.4);
        }

        .btn-primary:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(0, 255, 255, 0.5);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-secondary:hover {
            background: var(--primary);
            color: var(--dark);
            box-shadow: 0 0 30px var(--primary);
        }

        /* Scroll Indicator */
        .scroll-indicator {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-muted);
            font-size: 0.85rem;
            animation: scroll-bounce 2s ease-in-out infinite;
        }

        .scroll-indicator::after {
            content: '↓';
            font-size: 1.5rem;
            color: var(--primary);
        }

        @keyframes scroll-bounce {
            0%, 100% { transform: translateX(-50%) translateY(0); }
            50% { transform: translateX(-50%) translateY(10px); }
        }

        .contact-badges {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 2rem;
        }

        .badge {
            padding: 0.8rem 1.5rem;
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid var(--primary);
            border-radius: 30px;
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
            position: relative;
            overflow: hidden;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        .badge::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--primary);
            transition: width 0.6s, height 0.6s, top 0.6s, left 0.6s;
            transform: translate(-50%, -50%);
            z-index: -1;
        }

        .badge:hover::before,
        .badge:active::before {
            width: 300px;
            height: 300px;
        }

        .badge:hover,
        .badge:active {
            color: var(--dark);
            box-shadow: 0 0 30px var(--primary);
            transform: translateY(-5px) scale(1.05);
        }

        /* Section Styling - Enhanced */
        section {
            margin: 4rem 0;
            padding: 3rem 2rem;
            background: var(--glass);
            border-radius: 25px;
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
            perspective: 1000px;
        }

        section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s;
        }

        section.visible::before {
            transform: scaleX(1);
        }

        section::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(from 0deg, transparent, var(--primary), transparent 30%);
            animation: rotate-border 8s linear infinite;
            opacity: 0;
            transition: opacity 0.5s;
        }

        section:hover::after {
            opacity: 0.15;
        }

        @keyframes rotate-border {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .section-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: 2.5rem;
            text-align: center;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 3px;
            box-shadow: 0 0 10px var(--primary);
        }

        /* About Section */
        .about-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .about-card {
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(255, 0, 255, 0.05));
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            transition: all 0.4s;
            position: relative;
            overflow: hidden;
        }

        .about-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.2), transparent);
            transform: scale(0);
            transition: transform 0.6s;
        }

        .about-card:hover::after,
        .about-card:active::after {
            transform: scale(2);
        }

        .about-card:hover,
        .about-card:active {
            transform: translateY(-10px);
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.3);
            border-color: var(--primary);
        }

        .about-card h3 {
            color: var(--primary);
            margin-bottom: 1rem;
            font-size: clamp(1.2rem, 3vw, 1.5rem);
        }

        .about-card p {
            line-height: 1.8;
            color: #ccc;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        /* Skills Section */
        .skills-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .skill-category {
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.05), rgba(255, 255, 0, 0.05));
            border: 2px solid rgba(255, 0, 255, 0.3);
            border-radius: 15px;
            transition: all 0.4s;
        }

        .skill-category:hover,
        .skill-category:active {
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 15px 50px rgba(255, 0, 255, 0.4);
            border-color: var(--secondary);
        }

        .skill-category h3 {
            color: var(--secondary);
            margin-bottom: 1.5rem;
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            text-align: center;
        }

        .skill-tag {
            display: inline-block;
            padding: 0.5rem 1rem;
            margin: 0.3rem;
            background: rgba(255, 0, 255, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 20px;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            color: #fff;
            transition: all 0.3s;
            cursor: pointer;
        }

        .skill-tag:hover,
        .skill-tag:active {
            background: var(--secondary);
            color: var(--dark);
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.5);
        }

        /* Skill Proficiency Bars */
        .skill-with-bar {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .skill-bar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .skill-bar-name {
            color: var(--text-primary);
            font-weight: 600;
        }

        .skill-bar-level {
            color: var(--primary);
            font-size: 0.85rem;
        }

        .skill-bar-container {
            height: 8px;
            background: rgba(255, 0, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .skill-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px var(--primary);
        }

        .skill-bar-fill.animated {
            animation: skill-glow 2s ease-in-out infinite;
        }

        @keyframes skill-glow {
            0%, 100% { box-shadow: 0 0 5px var(--primary); }
            50% { box-shadow: 0 0 20px var(--primary), 0 0 30px var(--secondary); }
        }

        /* Theme Transition Animation */
        html {
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        html.theme-transitioning * {
            transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease !important;
        }

        /* Timeline Animation */
        .timeline-item {
            opacity: 0;
            transform: translateX(-50px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .timeline-item:nth-child(even) {
            transform: translateX(50px);
        }

        .timeline-item.visible {
            opacity: 1;
            transform: translateX(0);
        }

        /* Achievement Gallery */
        .achievement-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .achievement-item {
            padding: 1rem;
            background: rgba(255, 255, 0, 0.05);
            border: 2px solid rgba(255, 255, 0, 0.3);
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .achievement-item.unlocked {
            border-color: var(--accent);
            background: rgba(255, 255, 0, 0.1);
        }

        .achievement-item.locked {
            opacity: 0.4;
            filter: grayscale(1);
        }

        .achievement-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 255, 0, 0.2);
        }

        .achievement-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .achievement-title {
            font-size: 0.85rem;
            color: var(--accent);
            font-weight: 600;
        }

        /* Stats Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stat-card {
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(255, 0, 255, 0.05));
            border: 2px solid var(--border-color);
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            font-family: var(--font-display);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        /* Experience Timeline */
        .timeline {
            position: relative;
            padding: 2rem 0;
            z-index: 1;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--secondary), var(--accent));
            box-shadow: 0 0 20px var(--primary);
        }

        .timeline-item {
            position: relative;
            margin: 2rem 0;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
        }

        .timeline-content {
            padding: 1.5rem;
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 15px;
            position: relative;
            transition: all 0.4s;
        }

        .timeline-item:nth-child(even) .timeline-content {
            grid-column: 2;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            grid-column: 1;
        }

        .timeline-content::before {
            content: '';
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            box-shadow: 0 0 20px var(--primary);
        }

        .timeline-item:nth-child(odd) .timeline-content::before {
            right: -62px;
        }

        .timeline-item:nth-child(even) .timeline-content::before {
            left: -62px;
        }

        .timeline-content:hover,
        .timeline-content:active {
            transform: scale(1.05);
            box-shadow: 0 10px 40px rgba(0, 255, 255, 0.3);
            border-color: var(--primary);
        }

        .timeline-content h3 {
            color: var(--primary);
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            margin-bottom: 0.5rem;
        }

        .timeline-content .date {
            color: var(--accent);
            font-size: clamp(0.8rem, 2vw, 0.9rem);
            margin-bottom: 1rem;
        }

        .timeline-content p {
            color: #ccc;
            line-height: 1.6;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .timeline-content ul {
            margin-top: 1rem;
            padding-left: 1.5rem;
        }

        .timeline-content li {
            color: #aaa;
            margin: 0.5rem 0;
            line-height: 1.6;
            font-size: clamp(0.85rem, 2vw, 0.95rem);
        }

        /* Projects Grid - Enhanced 3D */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            position: relative;
            z-index: 1;
        }

        .project-card {
            padding: 2rem;
            background: linear-gradient(135deg, rgba(255, 255, 0, 0.03), rgba(0, 255, 255, 0.03));
            border: 2px solid rgba(255, 255, 0, 0.2);
            border-radius: 20px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .project-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 0, 0.15), transparent);
            transition: left 0.6s;
        }

        .project-card:hover::before {
            left: 100%;
        }

        .project-card::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255, 0, 255, 0.05), rgba(0, 255, 255, 0.05));
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: 20px;
        }

        .project-card:hover::after {
            opacity: 1;
        }

        .project-card:hover {
            transform: translateY(-15px) rotateX(5deg) rotateY(-5deg);
            box-shadow: 
                0 30px 60px rgba(255, 255, 0, 0.3),
                0 0 0 1px rgba(255, 255, 0, 0.5);
            border-color: var(--accent);
        }

        .project-card h3 {
            color: var(--accent);
            font-family: var(--font-display);
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .project-card p {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 1rem;
            font-size: clamp(0.9rem, 2vw, 1rem);
            position: relative;
            z-index: 1;
        }

        .project-tech {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .tech-badge {
            padding: 0.4rem 1rem;
            background: rgba(255, 255, 0, 0.1);
            border: 1px solid var(--accent);
            border-radius: 20px;
            font-family: var(--font-body);
            font-size: clamp(0.75rem, 2vw, 0.85rem);
            color: var(--accent);
            transition: all 0.3s;
        }

        .tech-badge:hover {
            background: var(--accent);
            color: var(--dark);
            transform: scale(1.1);
        }

        /* Certifications */
        .certs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            position: relative;
            z-index: 1;
        }

        .cert-card {
            padding: 1.5rem;
            background: rgba(0, 255, 255, 0.05);
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .cert-card:hover,
        .cert-card:active {
            background: rgba(0, 255, 255, 0.1);
            border-color: var(--primary);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.3);
        }

        .cert-card h4 {
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .cert-card p {
            color: #aaa;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 2rem;
            margin-top: 4rem;
            border-top: 2px solid rgba(0, 255, 255, 0.2);
            background: rgba(5, 5, 5, 0.8);
        }

        footer p {
            color: #888;
            font-size: clamp(0.8rem, 2vw, 0.9rem);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .timeline::before {
                left: 20px;
            }

            .timeline-item {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .timeline-item .timeline-content {
                grid-column: 1 !important;
                margin-left: 3rem;
            }

            .timeline-content::before {
                left: -42px !important;
                right: auto !important;
                width: 16px;
                height: 16px;
            }

            .moon {
                width: 80px;
                height: 80px;
                top: 5%;
                right: 5%;
            }

            .planet-1, .planet-2 {
                width: 40px;
                height: 40px;
            }
            
            /* Safe area support for notched devices */
            body {
                padding-left: env(safe-area-inset-left, 0);
                padding-right: env(safe-area-inset-right, 0);
            }
            
            .nav-header {
                padding-left: calc(1rem + env(safe-area-inset-left, 0));
                padding-right: calc(1rem + env(safe-area-inset-right, 0));
            }
            
            /* Better touch targets on mobile */
            .btn {
                min-height: 44px;
                padding: 0.8rem 1.5rem;
            }
            
            .badge {
                min-height: 44px;
                display: inline-flex;
                align-items: center;
            }
            
            /* Prevent horizontal scroll on small screens */
            section {
                overflow-x: hidden;
            }
            
            /* Improve notification positioning on mobile */
            .notification {
                left: 1rem;
                right: 1rem;
                bottom: -100px;
                min-width: auto;
            }
            
            .notification.show {
                bottom: calc(5rem + env(safe-area-inset-bottom, 0));
            }
        }
        
        /* Extra small screens (320px) */
        @media (max-width: 360px) {
            .hero-title {
                font-size: 2.5rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .hero-buttons {
                flex-direction: column;
            }
            
            .contact-badges {
                flex-direction: column;
                align-items: center;
            }
            
            .skills-grid,
            .projects-grid {
                grid-template-columns: 1fr;
            }
            
            .certs-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Scroll Progress Bar */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            width: 0%;
            z-index: 9999;
            box-shadow: 0 0 20px var(--primary);
        }

        /* Floating Particles */
        .particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: var(--primary);
            border-radius: 50%;
            pointer-events: none;
            animation: particle-float 3s ease-out forwards;
            box-shadow: 0 0 10px var(--primary);
        }

        @keyframes particle-float {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        /* Loading Screen */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--darker);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s;
        }

        #loadingScreen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .loader {
            width: 100px;
            height: 100px;
            border: 5px solid rgba(0, 255, 255, 0.1);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            margin-top: 2rem;
            font-size: clamp(1rem, 3vw, 1.5rem);
            color: var(--primary);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Entry Choice Screen */
        .entry-choice-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #1a1a2e 0%, #0a0a0f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100001;
            transition: opacity 0.5s, visibility 0.5s;
        }

        .entry-choice-screen.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .choice-container {
            max-width: 600px;
            padding: 3rem;
            text-align: center;
            animation: slideUp 0.6s ease-out;
        }

        .choice-title {
            font-family: var(--font-display);
            font-size: clamp(2rem, 5vw, 3rem);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .choice-subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: clamp(0.9rem, 2vw, 1.1rem);
        }

        .choice-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .choice-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1.5rem;
            text-align: center;
            width: 100%;
        }

        .btn-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .btn-text {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .btn-subtext {
            font-size: 0.85rem;
            opacity: 0.7;
            margin-top: 0.25rem;
        }

        .remember-choice {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            color: var(--text-muted);
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 1rem;
        }

        .remember-choice input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .returning-visitor {
            margin-top: 1rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .returning-visitor a {
            color: var(--primary);
            text-decoration: underline;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Notification System */
        .notification {
            position: fixed;
            bottom: -100px;
            right: 2rem;
            background: var(--bg-card);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            z-index: 100000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            transition: bottom 0.3s ease;
            min-width: 300px;
        }

        .notification.show {
            bottom: 2rem;
        }

        .notification-success { border-color: var(--success); }
        .notification-error { border-color: var(--danger); }
        .notification-info { border-color: var(--primary); }

        .notification-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .notification-message {
            color: var(--text-primary);
            font-weight: 500;
            flex: 1;
        }

        .notification-close {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s;
        }

        .notification-close:hover {
            color: var(--text-primary);
        }

        /* PWA Install Prompt */
        .install-prompt {
            position: fixed;
            bottom: -200px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--bg-card);
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 1.5rem;
            max-width: 400px;
            width: 90%;
            z-index: 100000;
            box-shadow: 0 10px 50px rgba(0, 255, 255, 0.3);
            transition: bottom 0.4s ease;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .install-prompt.show {
            bottom: 2rem;
        }

        .install-prompt-header {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .install-prompt-icon {
            font-size: 2rem;
        }

        .install-prompt-text h3 {
            color: var(--primary);
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
        }

        .install-prompt-text p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .install-prompt-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .install-prompt .btn {
            flex: 1;
            padding: 0.8rem;
            font-size: 0.9rem;
        }

        /* Project Modal */
        .modal {
            position: fixed;
            inset: 0;
            z-index: 100002;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            padding: 1rem;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-backdrop {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            position: relative;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
            transform: scale(0.9);
            transition: transform 0.3s;
            z-index: 1;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid var(--danger);
            color: var(--danger);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            z-index: 2;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
            transform: rotate(90deg);
        }

        .modal-body h2 {
            color: var(--primary);
            font-family: var(--font-display);
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: 2rem;
            text-align: center;
        }

        .modal-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .modal-gallery img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: transform 0.3s, border-color 0.3s;
        }

        .modal-gallery img:hover {
            transform: scale(1.05);
            border-color: var(--primary);
        }

        .detail-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(0, 255, 255, 0.05);
            border-left: 4px solid var(--primary);
            border-radius: 10px;
        }

        .detail-section h3 {
            color: var(--primary);
            font-family: var(--font-display);
            font-size: 1.3rem;
            margin-bottom: 1rem;
        }

        .detail-section p {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .detail-section ul {
            list-style: none;
            padding: 0;
        }

        .detail-section li {
            color: var(--text-secondary);
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .detail-section li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        .tech-stack-detailed {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tech-stack-detailed .tech-badge {
            padding: 0.5rem 1rem;
            background: rgba(255, 0, 255, 0.1);
            border: 2px solid var(--secondary);
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .project-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        /* Stats Dashboard */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .stat-card {
            padding: 2rem 1.5rem;
            background: linear-gradient(135deg, rgba(0, 255, 255, 0.05), rgba(255, 0, 255, 0.05));
            border: 2px solid var(--border-color);
            border-radius: 20px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.1), transparent 70%);
            opacity: 0;
            transition: opacity 0.4s;
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 255, 255, 0.3);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-size: clamp(2rem, 5vw, 3rem);
            font-weight: 900;
            font-family: var(--font-display);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Project Filters */
        .projects-controls {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filter-tags {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-tag {
            padding: 0.6rem 1.5rem;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            border-radius: 25px;
            font-family: var(--font-display);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-tag:hover,
        .filter-tag.active {
            background: var(--primary);
            color: var(--dark);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
        }

        .project-hint {
            color: var(--text-muted);
            font-size: 0.8rem;
            margin-top: 1rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .project-card:hover .project-hint {
            opacity: 1;
        }

        /* GitHub Activity Feed */
        .github-feed {
            display: grid;
            gap: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            background: rgba(0, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            transition: all 0.3s;
        }

        .activity-item:hover {
            border-color: var(--primary);
            transform: translateX(10px);
        }

        .activity-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-content p {
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .activity-time {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        /* Testimonials Section */
        .testimonials-slider {
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .testimonial-track {
            display: flex;
            gap: 2rem;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth;
            padding: 1rem;
            -webkit-overflow-scrolling: touch;
        }

        .testimonial-track::-webkit-scrollbar {
            display: none;
        }

        .testimonial-card {
            flex: 0 0 100%;
            scroll-snap-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, rgba(255, 255, 0, 0.05), rgba(0, 255, 255, 0.05));
            border: 2px solid rgba(255, 255, 0, 0.3);
            border-radius: 20px;
            text-align: center;
        }

        .testimonial-stars {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .testimonial-text {
            color: var(--text-secondary);
            font-size: 1.1rem;
            line-height: 1.8;
            font-style: italic;
            margin-bottom: 1.5rem;
        }

        .testimonial-author {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
        }

        .author-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--dark);
            font-weight: bold;
        }

        .author-info h4 {
            color: var(--primary);
            font-size: 1.1rem;
        }

        .author-info p {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .slider-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }

        .slider-dots .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(0, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .slider-dots .dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }

        /* Cookie Consent */
        .cookie-consent {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border-top: 2px solid var(--primary);
            padding: 1.5rem;
            z-index: 100000;
            transform: translateY(100%);
            transition: transform 0.4s ease;
        }

        .cookie-consent.show {
            transform: translateY(0);
        }

        .cookie-consent.hidden {
            display: none;
        }

        .cookie-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .cookie-content p {
            color: var(--text-secondary);
            flex: 1;
            min-width: 250px;
        }

        .cookie-content a {
            color: var(--primary);
            text-decoration: underline;
        }

        .cookie-actions {
            display: flex;
            gap: 1rem;
        }

        .btn-sm {
            padding: 0.5rem 1.5rem;
            font-size: 0.9rem;
        }

        /* Fade animation for filtering */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease forwards;
        }

        /* Scrollbar styling for modal */
        .modal-content::-webkit-scrollbar {
            width: 10px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 5px;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: var(--secondary);
        }

        /* Cosmic Ring Animation */
        .cosmic-ring {
            position: fixed;
            width: 300px;
            height: 300px;
            border: 2px solid rgba(0, 255, 255, 0.3);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: ring-pulse 4s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes ring-pulse {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.3;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.5);
                opacity: 0;
            }
        }
    </style>
    </head>
    <body>
    <!-- Aurora Background Effect -->
    <div class="aurora-bg" aria-hidden="true"></div>
    <div class="cyber-grid" aria-hidden="true"></div>
    
    <!-- Custom Cursor (disabled) -->
    <div class="custom-cursor" id="cursor"></div>
    <div class="cursor-dot" id="cursorDot"></div>

    <!-- XP System -->
    <div class="xp-bar-container" role="progressbar" aria-label="Experience progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
        <div class="xp-bar-fill" id="xpBarFill"></div>
    </div>
    <div class="xp-display" id="xpDisplay" role="status" aria-live="polite">
        <span class="xp-level">⭐ Level <span id="playerLevel">1</span></span>
        <span class="xp-points"><span id="playerXP">0</span> XP</span>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h3>🏆 Achievement Unlocked!</h3>
        <div class="badge-icon" id="achievementBadge">🎮</div>
        <p class="badge-name" id="achievementName">Explorer</p>
        <p class="xp-reward" id="achievementXP">+100 XP</p>
    </div>

    <!-- Combo Popup -->
    <div class="combo-popup" id="comboPopup">COMBO x5!</div>

    <!-- Easter Egg Text -->
    <div class="easter-egg-text" id="easterEggText">🎉 KONAMI CODE ACTIVATED! 🎉</div>

    <!-- CRT Overlay -->
    <div class="crt-overlay" id="crtOverlay"></div>

    <!-- Skip Navigation Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light theme" title="Toggle Theme">
        🌙
    </button>
    
        <!-- Navigation Header -->
        <nav class="nav-header" id="navHeader" role="navigation" aria-label="Main navigation">
            <div class="nav-logo">KM</div>
            <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Toggle menu">☰</button>
            <ul class="nav-links" id="navLinks">
                <li><a href="#about" class="nav-link">About</a></li>
                <li><a href="#skills" class="nav-link">Skills</a></li>
                <li><a href="#experience" class="nav-link">Experience</a></li>
                <li><a href="#stats" class="nav-link">Stats</a></li>
                <li><a href="#projects" class="nav-link">Projects</a></li>
                <li><a href="#testimonials" class="nav-link">Testimonials</a></li>
                <li><a href="#contact" class="nav-link">Contact</a></li>
            </ul>
        </nav>
    
        <!-- Section Indicator -->
        <div class="section-indicator" id="sectionIndicator" aria-hidden="true">
            <div class="section-dot" data-section="about" title="About"></div>
            <div class="section-dot" data-section="skills" title="Skills"></div>
            <div class="section-dot" data-section="experience" title="Experience"></div>
            <div class="section-dot" data-section="stats" title="Stats"></div>
            <div class="section-dot" data-section="projects" title="Projects"></div>
            <div class="section-dot" data-section="certifications" title="Certifications"></div>
            <div class="section-dot" data-section="testimonials" title="Testimonials"></div>
            <div class="section-dot" data-section="contact" title="Contact"></div>
        </div>
    
        <!-- Back to Top Button -->
        <button class="back-to-top" id="backToTop" aria-label="Back to top" title="Back to Top">
            ↑
        </button>
    
        <!-- WhatsApp Float Button -->
        <a href="https://wa.me/917019880061?text=Hi%20Karthik!%20I%20visited%20your%20portfolio." 
           class="whatsapp-float" 
           target="_blank" 
           rel="noopener noreferrer" 
           aria-label="Chat on WhatsApp"
           title="Chat on WhatsApp">
            💬
        </a>

    <!-- Entry Choice Screen -->
    <div id="entryChoice" class="entry-choice-screen hidden">
        <div class="choice-container glass-card">
            <h2 class="choice-title">🚀 Welcome to My Portfolio</h2>
            <p class="choice-subtitle">How would you like to explore?</p>
            
            <div class="choice-buttons">
                <button class="btn btn-primary choice-btn" id="playGameBtn" aria-label="Play mini-game">
                    <span class="btn-icon">🎮</span>
                    <span class="btn-text">Play Mini-Game</span>
                    <span class="btn-subtext">2-3 minutes of fun</span>
                </button>
                
                <button class="btn btn-secondary choice-btn" id="viewPortfolioBtn" aria-label="View portfolio directly">
                    <span class="btn-icon">📄</span>
                    <span class="btn-text">View Portfolio</span>
                    <span class="btn-subtext">Skip directly to content</span>
                </button>
            </div>
            
            <label class="remember-choice">
                <input type="checkbox" id="rememberChoiceCheckbox"> 
                <span>Remember my choice</span>
            </label>
            
            <p class="returning-visitor hidden" id="returningVisitor">
                Welcome back! <a href="#" id="resetPreference">Change preference</a>
            </p>
        </div>
    </div>

    <!-- Loading Screen -->
        <div id="loadingScreen" role="alert" aria-live="polite">
            <div class="loader-container">
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
            </div>
            <div class="loader-text">INITIALIZING KM PORTFOLIO...</div>
            <div class="loading-progress">
                <div class="loading-progress-bar" id="loadingProgressBar"></div>
            </div>
            <div class="loading-percent" id="loadingPercent">0%</div>
            <div class="loading-tips" id="loadingTips">💡 Tip: Try the Konami Code for a surprise!</div>
        </div>

    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- Space Background -->
    <div class="space-bg">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="stars3"></div>
        <div class="nebula"></div>
        <div class="moon"></div>
        <div class="planet planet-1"></div>
        <div class="planet planet-2"></div>
        <div class="cosmic-ring"></div>
    </div>

    <!-- Game Container -->
    <div id="gameContainer" role="application" aria-label="Space Defender Ultra Game">
        <button class="sound-toggle" id="soundToggle" aria-label="Toggle sound" title="Toggle Sound">🔊</button>
        <h1 class="game-title">🚀 SPACE DEFENDER ULTRA 🚀</h1>
        
        <!-- Game Mode Selector -->
        <div class="game-modes" role="radiogroup" aria-label="Game mode">
            <button class="mode-btn active" data-mode="classic">🎮 Classic</button>
            <button class="mode-btn" data-mode="survival">💀 Survival</button>
            <button class="mode-btn" data-mode="boss">👹 Boss Rush</button>
            <button class="mode-btn" data-mode="endless">♾️ Endless</button>
        </div>
        
        <!-- Difficulty Selector -->
        <div class="difficulty-selector" role="radiogroup" aria-label="Game difficulty">
            <button class="difficulty-btn easy" data-difficulty="easy" aria-pressed="false">Easy</button>
            <button class="difficulty-btn medium active" data-difficulty="medium" aria-pressed="true">Medium</button>
            <button class="difficulty-btn hard" data-difficulty="hard" aria-pressed="false">Hard</button>
        </div>
        
        <div class="game-wrapper" id="gameWrapper">
            <canvas id="gameCanvas" aria-label="Game canvas"></canvas>
            <div class="boss-warning" id="bossWarning">⚠️ BOSS INCOMING! ⚠️</div>
            <div class="game-combo" id="gameCombo">COMBO x5!</div>
            <div class="pause-overlay" id="pauseOverlay">
                <h2>⏸️ PAUSED</h2>
                <p>Press P or tap here to resume</p>
            </div>
        </div>
        
        <!-- Weapon Selector -->
        <div class="weapon-selector">
            <button class="weapon-btn active" data-weapon="laser">🔫 Laser</button>
            <button class="weapon-btn locked" data-weapon="plasma" title="Unlock at 500 score">⚡ Plasma</button>
            <button class="weapon-btn locked" data-weapon="missile" title="Unlock at 1000 score">🚀 Missile</button>
            <button class="weapon-btn locked" data-weapon="spread" title="Unlock at 750 score">💫 Spread</button>
        </div>
        
        <p class="game-instructions">
            🎮 Arrow Keys + SPACE to shoot | P = Pause | ESC = Skip<br>
            Touch: Tap to Move & Shoot | Destroy 15 Enemies or Beat the BOSS!
        </p>
        
        <div class="game-stats">
            <span>🏆 High Score: <span id="highScoreDisplay">0</span></span>
            <span>🔥 Best Combo: <span id="bestComboDisplay">0</span></span>
        </div>
        
        <div class="touch-controls">
            <div class="touch-btn" id="leftBtn" role="button" aria-label="Move left">⬅️</div>
            <div class="touch-btn" id="shootBtn" role="button" aria-label="Shoot">🔥</div>
            <div class="touch-btn" id="rightBtn" role="button" aria-label="Move right">➡️</div>
        </div>
        
        <button class="skip-game-btn" id="skipGameBtn" aria-label="Skip game and go to portfolio">
            ⏭️ Skip to Portfolio
        </button>
    </div>

    <!-- Portfolio Content -->
    <div id="portfolio" role="main">
        <main id="main-content">
        <!-- Header -->
        <header>
            <h1 class="hero-title">KARTHIK M</h1>
            <p class="hero-subtitle"><span class="typewriter" id="typewriter"></span></p>
            <div class="company-badge">
                Currently @ Eurofins IT Solutions India Pvt Ltd
            </div>
            
            <!-- Status badges container (populated via JS) -->
            <div id="openToWorkBadge"></div>
            
            <!-- Availability Status Widget -->
            <div id="availabilityStatus" style="margin: 1rem 0;"></div>
            
            <p class="hero-tagline">
                Passionate .NET Full Stack Developer building enterprise-grade web applications with C#, ASP.NET Core, Angular, and Azure. 
                3+ years of experience delivering scalable solutions for e-commerce and healthcare domains.
            </p>
            
            <!-- Hero Buttons -->
            <div class="hero-buttons">
                <button onclick="generateResumePDF()" class="btn btn-primary" aria-label="Download Resume">
                    📄 Download Resume
                </button>
                <a href="#contact" class="btn btn-secondary" aria-label="Contact me">
                    💬 Let's Talk
                </a>
                <button onclick="window.resumeAnalyzer?.open()" class="btn btn-accent" aria-label="AI Job Match Analyzer">
                    🔍 AI Job Match
                </button>
            </div>
            
            <!-- Unified Contact Section -->
            <div class="contact-badges">
                <a href="mailto:iammrkarthik2002@gmail.com" class="badge" aria-label="Send email">Email</a>
                <a href="tel:+917019880061" class="badge" aria-label="Call phone">+91 7019880061</a>
                <a href="https://linkedin.com/in/karthik-m-9262a02b4" class="badge" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn profile">LinkedIn</a>
                <a href="https://github.com/Karthik77-kk" class="badge" target="_blank" rel="noopener noreferrer" aria-label="GitHub profile">GitHub</a>
            </div>
            
            <!-- Social Share - placed after main contacts -->
            <div id="socialShare" style="margin-top: 1rem;"></div>
            
            <div class="scroll-indicator">Scroll to explore</div>
        </header>

        <!-- About Section -->
        <section id="about">
            <h2 class="section-title">ABOUT ME</h2>
            <div class="about-content">
                <div class="about-card">
                    <h3>🎓 Education</h3>
                    <p>
                        <strong>Bachelor of Computer Applications (BCA)</strong><br>
                        RNS First Grade College, Bangalore University<br>
                        CGPA: 7.04/10 | 2020-2023
                    </p>
                </div>
                <div class="about-card">
                    <h3>💼 Professional Experience</h3>
                    <p>
                        <strong>Software Developer</strong><br>
                        Eurofins IT Solutions India Pvt Ltd<br>
                        Present
                    </p>
                    <p style="margin-top: 1rem;">
                        <strong>.NET Full Stack Developer / Software Engineer</strong><br>
                        Accenture<br>
                        Nov 2022 - Nov 2025 (3 Years)
                    </p>
                    <p style="margin-top: 0.5rem;">
                        Built enterprise-grade shopping and healthcare web applications using .NET Core, ASP.NET MVC, C#, and Angular. 
                        Expertise in RESTful API development, SQL Server, Entity Framework, and Azure cloud services.
                    </p>
                </div>
                <div class="about-card">
                    <h3>🎯 Expertise</h3>
                    <p>
                        Specialized in .NET full-stack development with expertise in C#, ASP.NET Core, and modern JavaScript frameworks. 
                        Experienced in building scalable enterprise applications for e-commerce and healthcare domains.
                        Strong foundation in database design, cloud deployment (Azure), and DevOps practices.
                        Passionate about creating efficient, maintainable, and high-performance solutions.
                    </p>
                </div>
            </div>
        </section>

        <!-- Skills Section -->
        <section id="skills" aria-labelledby="skills-title">
            <h2 class="section-title" id="skills-title">TECHNICAL ARSENAL</h2>
            <div class="skills-grid">
                <div class="skill-category">
                    <h3>💻 Programming Languages</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="2+ years experience" tabindex="0">C#</span>
                        <span class="skill-tag" data-tooltip="3+ years experience" tabindex="0">Python</span>
                        <span class="skill-tag" data-tooltip="Web development" tabindex="0">JavaScript</span>
                        <span class="skill-tag" data-tooltip="TypeScript expert" tabindex="0">TypeScript</span>
                        <span class="skill-tag" data-tooltip="Database queries" tabindex="0">SQL</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>🔷 .NET Technologies</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="Backend framework" tabindex="0">.NET Core</span>
                        <span class="skill-tag" data-tooltip="Web development" tabindex="0">ASP.NET MVC</span>
                        <span class="skill-tag" data-tooltip="Web API" tabindex="0">ASP.NET Web API</span>
                        <span class="skill-tag" data-tooltip="ORM" tabindex="0">Entity Framework</span>
                        <span class="skill-tag" data-tooltip="Dependency injection" tabindex="0">LINQ</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>🌐 Frontend Technologies</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="Modern framework" tabindex="0">Angular</span>
                        <span class="skill-tag" data-tooltip="UI library" tabindex="0">React</span>
                        <span class="skill-tag" data-tooltip="Semantic markup" tabindex="0">HTML5</span>
                        <span class="skill-tag" data-tooltip="Responsive design" tabindex="0">CSS3/SCSS</span>
                        <span class="skill-tag" data-tooltip="CSS framework" tabindex="0">Bootstrap</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>🗄️ Databases</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="Enterprise DB" tabindex="0">SQL Server</span>
                        <span class="skill-tag" data-tooltip="Relational DB" tabindex="0">MySQL</span>
                        <span class="skill-tag" data-tooltip="NoSQL document DB" tabindex="0">MongoDB</span>
                        <span class="skill-tag" data-tooltip="In-memory caching" tabindex="0">Redis</span>
                        <span class="skill-tag" data-tooltip="Cloud database" tabindex="0">Azure SQL</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>☁️ Cloud & DevOps</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="Microsoft cloud" tabindex="0">Azure</span>
                        <span class="skill-tag" data-tooltip="Cloud computing" tabindex="0">AWS</span>
                        <span class="skill-tag" data-tooltip="Containerization" tabindex="0">Docker</span>
                        <span class="skill-tag" data-tooltip="CI/CD" tabindex="0">Azure DevOps</span>
                        <span class="skill-tag" data-tooltip="Version control" tabindex="0">Git</span>
                    </div>
                </div>
                <div class="skill-category">
                    <h3>🔧 Tools & Practices</h3>
                    <div>
                        <span class="skill-tag" data-tooltip="IDE" tabindex="0">Visual Studio</span>
                        <span class="skill-tag" data-tooltip="Project management" tabindex="0">Jira</span>
                        <span class="skill-tag" data-tooltip="API testing" tabindex="0">Postman</span>
                        <span class="skill-tag" data-tooltip="Methodology" tabindex="0">Agile/Scrum</span>
                        <span class="skill-tag" data-tooltip="Unit testing" tabindex="0">xUnit/NUnit</span>
                    </div>
                </div>
            </div>
            
            <!-- 3D Skill Constellation -->
            <div id="skillConstellation" style="margin-top: 2rem;"></div>
            
            <!-- Skill Proficiency Radar Chart -->
            <div id="skillRadar" style="margin-top: 2rem;"></div>
            
            <!-- Floating Tech Badges -->
            <div id="floatingBadges" style="margin-top: 1rem;"></div>
        </section>

        <!-- Experience Section -->
        <section id="experience">
            <h2 class="section-title">PROFESSIONAL JOURNEY</h2>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Software Developer</h3>
                        <p class="date">Eurofins IT Solutions India Pvt Ltd | Present</p>
                        <ul>
                            <li>Contributing to enterprise-grade software solutions with focus on scalable architecture</li>
                            <li>Working with cutting-edge technologies to deliver high-quality software products</li>
                            <li>Performance optimization and implementation of industry best practices</li>
                        </ul>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>.NET Full Stack Developer / Software Engineer</h3>
                        <p class="date">Accenture | Nov 2022 - Nov 2025</p>
                        <ul>
                            <li>Developed enterprise shopping and e-commerce web applications using .NET Core, ASP.NET MVC, and C# with Angular frontend</li>
                            <li>Built healthcare management systems with patient data processing and HIPAA compliance</li>
                            <li>Created RESTful APIs and microservices architecture for scalable solutions</li>
                            <li>Worked with SQL Server, Entity Framework, and Azure cloud services</li>
                            <li>Implemented CI/CD pipelines and DevOps practices for efficient deployment</li>
                            <li>Collaborated with cross-functional teams using Agile/Scrum methodologies</li>
                            <li>Optimized application performance and ensured code quality through best practices</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section id="stats" aria-labelledby="stats-title">
            <h2 class="section-title" id="stats-title">BY THE NUMBERS</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">📝</div>
                    <div class="stat-value" data-target="50000">0</div>
                    <div class="stat-label">Lines of Code</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🏆</div>
                    <div class="stat-value" data-target="20">0</div>
                    <div class="stat-label">Certifications</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">💼</div>
                    <div class="stat-value" data-target="15">0</div>
                    <div class="stat-label">Projects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">📊</div>
                    <div class="stat-value" data-target="100">0</div>
                    <div class="stat-label">Dataset Size (K+)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🎯</div>
                    <div class="stat-value" data-target="91">0</div>
                    <div class="stat-label">ML Accuracy %</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🌐</div>
                    <div class="stat-value" data-target="4">0</div>
                    <div class="stat-label">Languages</div>
                </div>
            </div>
        </section>

        <!-- GitHub Stats Section - NEW -->
        <section id="github-stats" aria-labelledby="github-stats-title">
            <h2 class="section-title" id="github-stats-title">🐙 GITHUB CONTRIBUTIONS</h2>
            <div id="githubStats"></div>
        </section>

        <!-- Projects Section -->
        <section id="projects">
            <h2 class="section-title">FEATURED PROJECTS</h2>
            
            <!-- Interactive Code Playground -->
            <div id="codePlayground" style="margin-bottom: 3rem;"></div>
            
            <!-- Project Filters -->
            <div class="projects-controls">
                <div class="filter-tags">
                    <button class="filter-tag active" data-filter="all">All</button>
                    <button class="filter-tag" data-filter="python">Python</button>
                    <button class="filter-tag" data-filter="ml">ML/AI</button>
                    <button class="filter-tag" data-filter="iot">IoT</button>
                </div>
            </div>
            
            <div class="projects-grid">
                <div class="project-card" data-project="ai-job-hunter">
                    <h3>🤖 Enhanced AI Job Hunter</h3>
                    <p>
                        Advanced desktop application with Material 3 design featuring AI-powered job matching, resume creation, 
                        application tracking, and analytics. Built with Python 3.8+ and PyQt5 using MVC pattern.
                    </p>
                    <div class="project-tech">
                        <span class="tech-badge">Python</span>
                        <span class="tech-badge">PyQt5</span>
                        <span class="tech-badge">OpenAI API</span>
                        <span class="tech-badge">Material 3</span>
                    </div>
                    <p class="project-hint">👆 Click for details</p>
                </div>
                <div class="project-card" data-project="job-portal">
                    <h3>💼 AI-Driven Job Portal</h3>
                    <p>
                        NoSQL recruitment platform with automated resume parsing and real-time job matching. Implemented intelligent 
                        ranking algorithms reducing manual screening time by 25%.
                    </p>
                    <div class="project-tech">
                        <span class="tech-badge">MongoDB</span>
                        <span class="tech-badge">Redis</span>
                        <span class="tech-badge">Python</span>
                        <span class="tech-badge">ML</span>
                    </div>
                    <p class="project-hint">👆 Click for details</p>
                </div>
                <div class="project-card" data-project="hand-tracking-keyboard">
                    <h3>👋 Hand-Tracking Virtual Keyboard</h3>
                    <p>
                        Touchless typing system using computer vision and gesture recognition. Achieved 95% real-time gesture detection 
                        accuracy for accessible and hygienic data input.
                    </p>
                    <div class="project-tech">
                        <span class="tech-badge">OpenCV</span>
                        <span class="tech-badge">Python</span>
                        <span class="tech-badge">Computer Vision</span>
                        <span class="tech-badge">ML</span>
                    </div>
                    <p class="project-hint">👆 Click for details</p>
                </div>
                <div class="project-card" data-project="amazon-sales-analysis">
                    <h3>📊 Amazon Sales Data Analysis</h3>
                    <p>
                        Comprehensive sales forecasting pipeline using Python and machine learning. Achieved 91% accuracy in monthly 
                        trend predictions with statistical analysis.
                    </p>
                    <div class="project-tech">
                        <span class="tech-badge">Python</span>
                        <span class="tech-badge">Pandas</span>
                        <span class="tech-badge">scikit-learn</span>
                        <span class="tech-badge">Matplotlib</span>
                    </div>
                    <p class="project-hint">👆 Click for details</p>
                </div>
                <div class="project-card" data-project="rfid-automation">
                    <h3>🔐 RFID Door Automation System</h3>
                    <p>
                        IoT-based access control system using ESP32 microcontroller and RFID technology. Reduced manual access management 
                        by 80% while enhancing security.
                    </p>
                    <div class="project-tech">
                        <span class="tech-badge">ESP32</span>
                        <span class="tech-badge">RFID</span>
                        <span class="tech-badge">IoT</span>
                        <span class="tech-badge">C</span>
                    </div>
                    <p class="project-hint">👆 Click for details</p>
                </div>
            </div>
        </section>

        <!-- Certifications Section -->
            <section id="certifications" aria-labelledby="certifications-title">
                <h2 class="section-title" id="certifications-title">CERTIFICATIONS & ACHIEVEMENTS</h2>
                <div class="certs-grid">
                    <div class="cert-card" tabindex="0">
                        <h4>☁️ AWS Cloud Practitioner</h4>
                        <p>Amazon Web Services</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🔒 AWS Security Operations</h4>
                        <p>LinkedIn Learning</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🤖 Machine Learning</h4>
                        <p>Fundamentals & Advanced</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>📊 Data Analytics</h4>
                        <p>Professional Certificate</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🎨 Google UX Design</h4>
                        <p>Coursera Certificate</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🔄 Agile & Scrum</h4>
                        <p>Project Management</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🐍 Python Programming</h4>
                        <p>Advanced Certification</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🚀 REST APIs</h4>
                        <p>Development & Design</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🏆 Hackathon Coordinator</h4>
                        <p>200+ Participants</p>
                    </div>
                    <div class="cert-card" tabindex="0">
                        <h4>🥋 Martial Arts Green Belt</h4>
                        <p>Leadership & Discipline</p>
                    </div>
                </div>
            </section>

            <!-- Languages Section -->
            <section id="languages" aria-labelledby="languages-title">
                <h2 class="section-title" id="languages-title">LANGUAGES</h2>
                <div class="languages-grid">
                    <div class="language-card" tabindex="0">
                        <div class="flag">🇬🇧</div>
                        <h4>English</h4>
                        <p>Professional</p>
                    </div>
                    <div class="language-card" tabindex="0">
                        <div class="flag">🇮🇳</div>
                        <h4>Hindi</h4>
                        <p>Fluent</p>
                    </div>
                    <div class="language-card" tabindex="0">
                        <div class="flag">🇮🇳</div>
                        <h4>Kannada</h4>
                        <p>Native</p>
                    </div>
                    <div class="language-card" tabindex="0">
                        <div class="flag">🇮🇳</div>
                        <h4>Telugu</h4>
                        <p>Conversational</p>
                    </div>
                </div>
            </section>

            <!-- Hobbies & Interests Section -->
            <section id="hobbies" aria-labelledby="hobbies-title">
                <h2 class="section-title" id="hobbies-title">HOBBIES & INTERESTS</h2>
                <div class="hobbies-grid">
                    <div class="hobby-tag"><span class="emoji">💻</span> Coding</div>
                    <div class="hobby-tag"><span class="emoji">🎮</span> Gaming</div>
                    <div class="hobby-tag"><span class="emoji">📚</span> Reading Tech Blogs</div>
                    <div class="hobby-tag"><span class="emoji">🎵</span> Music</div>
                    <div class="hobby-tag"><span class="emoji">🥋</span> Martial Arts</div>
                    <div class="hobby-tag"><span class="emoji">🚀</span> Space Exploration</div>
                    <div class="hobby-tag"><span class="emoji">🤖</span> AI/ML Research</div>
                    <div class="hobby-tag"><span class="emoji">🎬</span> Movies</div>
                    <div class="hobby-tag"><span class="emoji">✈️</span> Traveling</div>
                    <div class="hobby-tag"><span class="emoji">📷</span> Photography</div>
                </div>
            </section>

            <!-- Testimonials Section - 3D Enhanced -->
            <section id="testimonials" aria-labelledby="testimonials-title">
                <h2 class="section-title" id="testimonials-title">WHAT PEOPLE SAY</h2>
                
                <!-- 3D Testimonials Carousel -->
                <div id="testimonialsCarousel"></div>
                
                <!-- Fallback: Original testimonials for browsers without JS -->
                <noscript>
                    <div class="testimonials-slider">
                        <div class="testimonial-track" id="testimonialTrack">
                            <div class="testimonial-card">
                                <div class="testimonial-stars">⭐⭐⭐⭐⭐</div>
                                <p class="testimonial-text">
                                    "Karthik demonstrated exceptional analytical skills during his internship. His work on data pipelines 
                                    and ML models showed remarkable attention to detail and innovative problem-solving abilities."
                                </p>
                                <div class="testimonial-author">
                                    <div class="author-avatar">DS</div>
                                    <div class="author-info">
                                        <h4>Data Science Team Lead</h4>
                                        <p>Prinston Smart, Bangalore</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </noscript>
            </section>

            <!-- GitHub Activity Section -->
            <section id="github-activity" aria-labelledby="github-title">
                <h2 class="section-title" id="github-title">RECENT ACTIVITY</h2>
                <div id="githubFeed" class="github-feed">
                    <div class="activity-loading">
                        <p style="text-align: center; color: var(--text-muted);">Loading GitHub activity...</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 1.5rem;">
                    <a href="https://github.com/Karthik77-kk" class="btn btn-secondary" target="_blank" rel="noopener noreferrer">
                        View All on GitHub
                    </a>
                </div>
            </section>

            <!-- Contact Form Section -->
            <section id="contact" aria-labelledby="contact-title">
                <h2 class="section-title" id="contact-title">GET IN TOUCH</h2>
                <p style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem; max-width: 600px; margin-left: auto; margin-right: auto;">
                    Have a project in mind or want to collaborate? Fill out the form below or reach me directly via email/WhatsApp!
                </p>
                <!-- 
                    FORM SETUP INSTRUCTIONS:
                    To enable form submission, choose ONE of these methods:
                    
                    METHOD 1 (Recommended - Formspree.io):
                    1. Visit https://formspree.io and sign up (FREE)
                    2. Create a new form
                    3. Replace 'YOUR_FORMSPREE_ID' in the action below with your form ID
                       Example: action="https://formspree.io/f/xabcdefg"
                    
                    METHOD 2 (Alternative - Netlify Forms):
                    If hosted on Netlify, just add: data-netlify="true"
                    
                    METHOD 3 (Email fallback):
                    Form will open default email client if no service configured
                -->
                <form class="contact-form" 
                      action="https://formspree.io/f/YOUR_FORMSPREE_ID" 
                      method="POST" 
                      id="contactForm"
                      novalidate>
                    <input type="hidden" name="_subject" value="New Portfolio Contact Form Submission">
                    <input type="hidden" name="_next" value="https://karthik77-kk.github.io/karthikm-resume/#contact">
                    <div class="form-group">
                        <label for="name">Your Name *</label>
                        <input type="text" id="name" name="name" required placeholder="John Doe" aria-required="true">
                        <span class="form-error" id="nameError"></span>
                    </div>
                    <div class="form-group">
                        <label for="email">Your Email *</label>
                        <input type="email" id="email" name="_replyto" required placeholder="john@example.com" aria-required="true">
                        <span class="form-error" id="emailError"></span>
                    </div>
                    <div class="form-group">
                        <label for="subject">Subject</label>
                        <input type="text" id="subject" name="subject" placeholder="Project Inquiry">
                    </div>
                    <div class="form-group">
                        <label for="message">Message *</label>
                        <textarea id="message" name="message" required placeholder="Tell me about your project or inquiry..." aria-required="true"></textarea>
                        <span class="form-error" id="messageError"></span>
                    </div>
                    <button type="submit" class="form-submit" id="submitBtn">
                        Send Message
                    </button>
                </form>
                <p style="text-align: center; margin-top: 1.5rem; color: var(--text-muted); font-size: 0.9rem;">
                    Or reach me directly via 
                    <a href="mailto:iammrkarthik2002@gmail.com" style="color: var(--primary); text-decoration: underline;">email</a> 
                    or 
                    <a href="https://wa.me/917019880061?text=Hi%20Karthik!%20I%20visited%20your%20portfolio." target="_blank" rel="noopener noreferrer" style="color: #25D366; text-decoration: underline;">WhatsApp</a>
                </p>
                
                <!-- Quick Actions: Copy Email & QR Code -->
                <div style="text-align: center; margin-top: 1.5rem; display: flex; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                    <button class="copy-email-btn" aria-label="Copy email address">Copy Email</button>
                    <button onclick="showQRCode()" class="btn btn-secondary" aria-label="Show QR code to connect">Show QR Code</button>
                    <button onclick="downloadVCard()" class="btn btn-secondary" aria-label="Download contact card">📇 Save Contact</button>
                </div>
            </section>
            </main>

            <!-- Project Case Study Modal -->
            <div class="modal" id="projectModal" role="dialog" aria-labelledby="modalTitle" aria-hidden="true">
                <div class="modal-backdrop" id="modalBackdrop"></div>
                <div class="modal-content glass-card-strong">
                    <button class="modal-close" id="modalClose" aria-label="Close modal">✕</button>
                    <div class="modal-body">
                        <h2 id="modalTitle">Project Title</h2>
                        
                        <div class="modal-gallery" id="modalGallery">
                            <!-- Screenshots will be inserted here -->
                        </div>
                        
                        <div class="detail-section">
                            <h3>🎯 Problem Statement</h3>
                            <p id="modalProblem"></p>
                        </div>
                        
                        <div class="detail-section">
                            <h3>💡 Solution & Approach</h3>
                            <p id="modalSolution"></p>
                        </div>
                        
                        <div class="detail-section">
                            <h3>📊 Results & Impact</h3>
                            <ul id="modalResults"></ul>
                        </div>
                        
                        <div class="detail-section">
                            <h3>🛠️ Tech Stack</h3>
                            <div id="modalTech" class="tech-stack-detailed"></div>
                        </div>
                        
                        <div class="detail-section">
                            <h3>🚀 Key Features</h3>
                            <ul id="modalFeatures"></ul>
                        </div>
                        
                        <div class="detail-section">
                            <h3>💭 Lessons Learned</h3>
                            <p id="modalLessons"></p>
                        </div>
                        
                        <div class="project-actions">
                            <a href="#" id="modalGithub" class="btn btn-primary" target="_blank">
                                <span>View on GitHub</span>
                            </a>
                            <a href="#" id="modalDemo" class="btn btn-secondary" target="_blank">
                                <span>Live Demo</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer role="contentinfo">
                <p>© 2025 Karthik M. Crafted with love in Bangalore. All Rights Reserved.</p>
                <p style="margin-top: 1rem;">Powered by Pure HTML, CSS & JavaScript | Optimized for All Devices</p>
                
                <!-- Visitor Counter & Last Updated -->
                <div id="visitorCounter" style="margin-top: 1rem;"></div>
                <div class="last-updated-container"></div>
                
                <p class="version-info">Version 4.1.2 ULTRA+ | Last Updated: January 2025</p>
                <p style="margin-top: 0.5rem; font-size: 0.7rem; color: var(--text-muted);">
                    Try the Konami Code for a surprise! | Wave System | Boss Battles | Power-ups
                </p>
            </footer>
        </div>

    <!-- jsPDF Library for Resume Generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" crossorigin="anonymous"></script>

    <script>
        // ==================== ULTRA CONFIGURATION V2 ====================
        const CONFIG = {
            GAME_WIN_KILLS: 15,
            BOSS_SPAWN_KILLS: 5,
            XP_PER_KILL: 10,
            XP_PER_COMBO: 25,
            XP_FOR_LEVEL: 500,
            MAX_LEVEL: 50,
            WAVE_KILLS_TO_ADVANCE: 5,
            MAX_WAVES: 10,
            difficulties: {
                easy: { enemySpeed: 1.5, spawnRate: 0.015, maxEnemies: 6, enemyHealth: 1, scoreMultiplier: 1, bossShootRate: 120, enemyShootChance: 0.002 },
                medium: { enemySpeed: 2.5, spawnRate: 0.025, maxEnemies: 10, enemyHealth: 2, scoreMultiplier: 1.5, bossShootRate: 80, enemyShootChance: 0.005 },
                hard: { enemySpeed: 4, spawnRate: 0.04, maxEnemies: 15, enemyHealth: 3, scoreMultiplier: 2, bossShootRate: 50, enemyShootChance: 0.01 }
            },
            weapons: {
                laser: { fireRate: 150, damage: 1, bullets: 1, color: '#00ffff', unlockScore: 0 },
                plasma: { fireRate: 100, damage: 2, bullets: 1, color: '#ff6600', unlockScore: 500 },
                spread: { fireRate: 200, damage: 1, bullets: 3, color: '#ff00ff', unlockScore: 750 },
                missile: { fireRate: 300, damage: 5, bullets: 1, color: '#ff0000', unlockScore: 1000 }
            },
            powerUpTypes: {
                shield: { color: '#00ff00', icon: '🛡️', duration: 8000 },
                rapidFire: { color: '#ff6600', icon: '⚡', duration: 8000 },
                doubleShot: { color: '#00ffff', icon: '🔫', duration: 8000 },
                health: { color: '#ff4444', icon: '❤️', duration: 0 },
                bomb: { color: '#ffff00', icon: '💣', duration: 0 },
                magnet: { color: '#ff00ff', icon: '🧲', duration: 10000 }
            },
            achievements: {
                first_kill: { name: 'First Blood', badge: '🩸', xp: 50 },
                combo_5: { name: 'Combo Master', badge: '🔥', xp: 100 },
                combo_10: { name: 'Combo Legend', badge: '💥', xp: 200 },
                boss_killer: { name: 'Boss Slayer', badge: '👹', xp: 300 },
                survivor: { name: 'Survivor', badge: '🛡️', xp: 150 },
                speedrun: { name: 'Speed Demon', badge: '⚡', xp: 250 },
                explorer: { name: 'Explorer', badge: '🧭', xp: 100 },
                konami: { name: 'Retro Gamer', badge: '🎮', xp: 500 },
                section_all: { name: 'Full Tour', badge: '🏆', xp: 200 },
                wave_5: { name: 'Wave Rider', badge: '🌊', xp: 150 },
                wave_10: { name: 'Wave Master', badge: '🏄', xp: 300 },
                no_damage: { name: 'Untouchable', badge: '👻', xp: 400 },
                bomb_clear: { name: 'Bomb Squad', badge: '💣', xp: 100 }
            },
            leaderboard: { maxEntries: 10 }
        };

        // ==================== STATE MANAGEMENT ====================
        const state = {
            currentDifficulty: 'medium',
            currentWeapon: 'laser',
            currentMode: 'classic',
            soundEnabled: true,
            isPaused: false,
            highScore: 0,
            bestCombo: 0,
            playerXP: 0,
            playerLevel: 1,
            achievements: [],
            sectionsVisited: [],
            konamiIndex: 0,
            konamiCode: ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a']
        };

        // Initialize state from localStorage after DOM is ready
        function initState() {
            state.highScore = parseInt(safeGetItem('spaceDefenderHighScore', '0')) || 0;
            state.bestCombo = parseInt(safeGetItem('spaceDefenderBestCombo', '0')) || 0;
            state.playerXP = parseInt(safeGetItem('portfolioXP', '0')) || 0;
            state.playerLevel = parseInt(safeGetItem('portfolioLevel', '1')) || 1;
            state.achievements = safeGetJSON('portfolioAchievements', []);
            state.sectionsVisited = safeGetJSON('sectionsVisited', []);
        }

        // ==================== DOM ELEMENTS ====================
        const $ = id => document.getElementById(id);
        const canvas = $('gameCanvas');
        const ctx = canvas ? canvas.getContext('2d') : null;
        const cursor = $('cursor');
        const cursorDot = $('cursorDot');
        const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

        // ==================== SAFE LOCALSTORAGE ====================
        function safeGetItem(key, defaultValue) {
            try {
                const item = localStorage.getItem(key);
                return item !== null ? item : defaultValue;
            } catch (e) {
                console.warn('localStorage not available:', e);
                return defaultValue;
            }
        }

        function safeSetItem(key, value) {
            try {
                localStorage.setItem(key, value);
            } catch (e) {
                console.warn('localStorage not available:', e);
            }
        }

        function safeGetJSON(key, defaultValue) {
            try {
                const item = localStorage.getItem(key);
                return item ? JSON.parse(item) : defaultValue;
            } catch (e) {
                console.warn('localStorage/JSON parse error:', e);
                return defaultValue;
            }
        }

        // ==================== CUSTOM CURSOR ====================
        let mouseX = 0, mouseY = 0, cursorX = 0, cursorY = 0;

        if (!isTouchDevice) {
            document.addEventListener('mousemove', e => {
                mouseX = e.clientX;
                mouseY = e.clientY;
                
                // Create cursor trail
                if (Math.random() < 0.3) {
                    const trail = document.createElement('div');
                    trail.className = 'cursor-trail';
                    trail.style.left = e.clientX + 'px';
                    trail.style.top = e.clientY + 'px';
                    trail.style.background = ['#00ffff', '#ff00ff', '#ffff00'][Math.floor(Math.random() * 3)];
                    document.body.appendChild(trail);
                    setTimeout(() => trail.remove(), 500);
                }
            });

            function animateCursor() {
                cursorX += (mouseX - cursorX) * 0.15;
                cursorY += (mouseY - cursorY) * 0.15;
                cursor.style.left = cursorX - 10 + 'px';
                cursor.style.top = cursorY - 10 + 'px';
                cursorDot.style.left = mouseX - 3 + 'px';
                cursorDot.style.top = mouseY - 3 + 'px';
                requestAnimationFrame(animateCursor);
            }
            animateCursor();

            // Magnetic effect for interactive elements
            document.querySelectorAll('a, button, .skill-tag, .cert-card, .project-card, .magnetic-btn').forEach(el => {
                el.addEventListener('mouseenter', () => cursor.classList.add('hover'));
                el.addEventListener('mouseleave', () => cursor.classList.remove('hover'));
            });
        }

        // ==================== NOTIFICATION SYSTEM ====================
        function showNotification(message, type = 'info', duration = 5000) {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <span class="notification-icon">${type === 'success' ? '✅' : type === 'error' ? '❌' : 'ℹ️'}</span>
                <span class="notification-message">${message}</span>
                <button class="notification-close" aria-label="Close notification">×</button>
            `;
            document.body.appendChild(notification);
            
            const closeBtn = notification.querySelector('.notification-close');
            closeBtn.addEventListener('click', () => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            });
            
            setTimeout(() => notification.classList.add('show'), 10);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        // ==================== ANALYTICS TRACKING ====================
        function trackEvent(eventName, params = {}) {
            // Google Analytics 4
            if (typeof gtag !== 'undefined') {
                gtag('event', eventName, params);
            }
            
            // Console log for development
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.log('📊 Analytics Event:', eventName, params);
            }
        }

        // Track page view
        function trackPageView(pageName) {
            trackEvent('page_view', {
                page_title: pageName,
                page_location: window.location.href,
                page_path: window.location.pathname
            });
        }

        // ==================== QR CODE FUNCTIONALITY ====================
        function showQRCode() {
            // Create QR code modal
            const modal = document.createElement('div');
            modal.className = 'qr-modal';
            modal.id = 'qrModal';
            modal.innerHTML = `
                <div class="qr-modal-backdrop" onclick="closeQRModal()"></div>
                <div class="qr-modal-content glass-card-strong">
                    <button class="qr-modal-close" onclick="closeQRModal()" aria-label="Close">×</button>
                    <h3 style="color: var(--primary); margin-bottom: 1rem; font-family: var(--font-display);">📱 Scan to Connect</h3>
                    <div class="qr-code-container" id="qrCodeContainer">
                        <canvas id="qrCanvas"></canvas>
                    </div>
                    <p style="color: var(--text-muted); margin-top: 1rem; font-size: 0.9rem;">Scan this QR code to view my portfolio on your mobile device</p>
                    <div style="margin-top: 1rem; display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                        <a href="https://linkedin.com/in/karthik-m-9262a02b4" target="_blank" class="btn btn-primary" style="font-size: 0.8rem;">LinkedIn</a>
                        <a href="https://github.com/Karthik77-kk" target="_blank" class="btn btn-secondary" style="font-size: 0.8rem;">GitHub</a>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Generate QR Code using canvas
            setTimeout(() => {
                generateQRCode('qrCanvas', window.location.href);
                modal.classList.add('show');
            }, 10);
            
            showNotification('QR Code generated! 📱', 'success');
            addXP(10, 'Viewed QR code');
        }
        
        function closeQRModal() {
            const modal = document.getElementById('qrModal');
            if (modal) {
                modal.classList.remove('show');
                setTimeout(() => modal.remove(), 300);
            }
        }
        
        function generateQRCode(canvasId, text) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const size = 200;
            canvas.width = size;
            canvas.height = size;
            
            // Simple QR-like pattern (visual placeholder - actual QR would need a library)
            // For a real QR code, we'd use qrcode.js library
            const cellSize = 10;
            const modules = Math.floor(size / cellSize);
            
            // Create a deterministic pattern based on URL
            const seed = text.split('').reduce((a, b) => a + b.charCodeAt(0), 0);
            
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(0, 0, size, size);
            
            ctx.fillStyle = '#000000';
            
            // Draw finder patterns (corners)
            drawFinderPattern(ctx, 0, 0, cellSize);
            drawFinderPattern(ctx, size - 7 * cellSize, 0, cellSize);
            drawFinderPattern(ctx, 0, size - 7 * cellSize, cellSize);
            
            // Draw data pattern
            for (let y = 0; y < modules; y++) {
                for (let x = 0; x < modules; x++) {
                    // Skip finder pattern areas
                    if ((x < 8 && y < 8) || (x >= modules - 8 && y < 8) || (x < 8 && y >= modules - 8)) {
                        continue;
                    }
                    // Deterministic pattern
                    const idx = y * modules + x;
                    if ((seed * (idx + 1)) % 3 === 0) {
                        ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
                    }
                }
            }
        }
        
        function drawFinderPattern(ctx, x, y, cellSize) {
            // Outer square
            ctx.fillRect(x, y, 7 * cellSize, 7 * cellSize);
            // White middle
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(x + cellSize, y + cellSize, 5 * cellSize, 5 * cellSize);
            // Inner square
            ctx.fillStyle = '#000000';
            ctx.fillRect(x + 2 * cellSize, y + 2 * cellSize, 3 * cellSize, 3 * cellSize);
        }

        // ==================== COPY EMAIL FUNCTIONALITY ====================
        function copyEmail() {
            const email = 'iammrkarthik2002@gmail.com';
            
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(email).then(() => {
                    showNotification('📧 Email copied to clipboard!', 'success');
                    addXP(5, 'Copied email');
                }).catch(err => {
                    fallbackCopyEmail(email);
                });
            } else {
                fallbackCopyEmail(email);
            }
        }
        
        function fallbackCopyEmail(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-9999px';
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                showNotification('📧 Email copied to clipboard!', 'success');
                addXP(5, 'Copied email');
            } catch (err) {
                showNotification('Failed to copy. Email: ' + text, 'error');
            }
            document.body.removeChild(textArea);
        }

        // ==================== GITHUB CONTRIBUTIONS VISUALIZATION ====================
        function initGitHubStats() {
            const container = document.getElementById('githubStats');
            if (!container) return;
            
            const username = 'Karthik77-kk';
            
            container.innerHTML = `
                <div class="github-stats-grid">
                    <div class="github-stat-card glass-card">
                        <img src="https://github-readme-stats.vercel.app/api?username=${username}&show_icons=true&theme=radical&hide_border=true&bg_color=0d1117&title_color=00ffff&icon_color=ff00ff&text_color=ffffff" 
                             alt="GitHub Stats" 
                             loading="lazy"
                             onerror="this.parentElement.innerHTML='<div style=\\'padding: 1rem; text-align: center; color: var(--text-muted);\\'>Stats temporarily unavailable</div>'"
                             style="width: 100%; height: auto; border-radius: 10px;">
                    </div>
                    <div class="github-stat-card glass-card">
                        <img src="https://github-readme-streak-stats.herokuapp.com/?user=${username}&theme=radical&hide_border=true&background=0d1117&ring=00ffff&fire=ff00ff&currStreakLabel=ffffff" 
                             alt="GitHub Streak" 
                             loading="lazy"
                             onerror="this.parentElement.innerHTML='<div style=\\'padding: 1rem; text-align: center; color: var(--text-muted);\\'>Streak stats temporarily unavailable</div>'"
                             style="width: 100%; height: auto; border-radius: 10px;">
                    </div>
                    <div class="github-stat-card glass-card" style="grid-column: 1 / -1;">
                        <img src="https://github-readme-activity-graph.vercel.app/graph?username=${username}&theme=react-dark&hide_border=true&bg_color=0d1117&color=00ffff&line=ff00ff&point=ffff00" 
                             alt="GitHub Activity Graph" 
                             loading="lazy"
                             onerror="this.parentElement.innerHTML='<div style=\\'padding: 1rem; text-align: center; color: var(--text-muted);\\'>Activity graph temporarily unavailable</div>'"
                             style="width: 100%; height: auto; border-radius: 10px;">
                    </div>
                </div>
            `;
        }

        // ==================== XP & GAMIFICATION SYSTEM ====================
        function addXP(amount, reason = '') {
            if (!amount || amount <= 0) return;
            state.playerXP += Math.floor(amount);
            
            // Level up check
            while (state.playerXP >= CONFIG.XP_FOR_LEVEL && state.playerLevel < CONFIG.MAX_LEVEL) {
                state.playerXP -= CONFIG.XP_FOR_LEVEL;
                state.playerLevel++;
                showAchievement('🎉', `Level ${state.playerLevel}!`, 0);
            }
            
            safeSetItem('portfolioXP', state.playerXP.toString());
            safeSetItem('portfolioLevel', state.playerLevel.toString());
            updateXPDisplay();
        }

        function updateXPDisplay() {
            const xpBarFill = $('xpBarFill');
            const playerLevel = $('playerLevel');
            const playerXP = $('playerXP');
            
            if (xpBarFill) {
                const xpPercent = (state.playerXP / CONFIG.XP_FOR_LEVEL) * 100;
                xpBarFill.style.width = xpPercent + '%';
            }
            if (playerLevel) playerLevel.textContent = state.playerLevel;
            if (playerXP) playerXP.textContent = state.playerXP;
        }

        function unlockAchievement(id) {
            if (!id || state.achievements.includes(id)) return;
            
            const achievement = CONFIG.achievements[id];
            if (!achievement) return;
            
            state.achievements.push(id);
            safeSetItem('portfolioAchievements', JSON.stringify(state.achievements));
            
            showAchievement(achievement.badge, achievement.name, achievement.xp);
            addXP(achievement.xp, `Achievement: ${achievement.name}`);
        }

        function showAchievement(badge, name, xp) {
            const popup = $('achievementPopup');
            const badgeEl = $('achievementBadge');
            const nameEl = $('achievementName');
            const xpEl = $('achievementXP');
            const gameContainer = $('gameContainer');
            
            if (!popup || !badgeEl || !nameEl || !xpEl) return;
            
            // Check if game is active (not hidden)
            const isGameActive = gameContainer && !gameContainer.classList.contains('hidden');
            
            badgeEl.textContent = badge;
            nameEl.textContent = name;
            xpEl.textContent = xp > 0 ? `+${xp} XP` : '';
            
            // Use corner mode during game to not block gameplay
            if (isGameActive) {
                popup.classList.add('game-mode');
            } else {
                popup.classList.remove('game-mode');
            }
            
            popup.classList.add('show');
            
            // Haptic feedback on mobile
            if (navigator.vibrate) {
                try { navigator.vibrate([100, 50, 100]); } catch(e) {}
            }
            
            // Shorter duration during game
            const duration = isGameActive ? 1500 : 3000;
            
            // Clear any existing timeout
            if (popup.hideTimeout) clearTimeout(popup.hideTimeout);
            
            popup.hideTimeout = setTimeout(() => {
                popup.classList.remove('show');
            }, duration);
        }

        // Click to dismiss achievement popup
        $('achievementPopup')?.addEventListener('click', function() {
            this.classList.remove('show');
            if (this.hideTimeout) clearTimeout(this.hideTimeout);
        });

        // ==================== LOADING SCREEN ====================
        const loadingTips = [
            '💡 Tip: Try the Konami Code for a surprise!',
            '💡 Tip: Click on skills to see more details!',
            '💡 Tip: Explore all sections for achievements!',
            '💡 Tip: Beat the boss for bonus XP!',
            '💡 Tip: Try different weapons as you score higher!'
        ];

        let loadingProgress = 0;
        const loadingInterval = setInterval(() => {
            loadingProgress += Math.random() * 12;
            if (loadingProgress >= 100) {
                loadingProgress = 100;
                clearInterval(loadingInterval);
            }
            const progressBar = $('loadingProgressBar');
            const percentEl = $('loadingPercent');
            const tipsEl = $('loadingTips');
            
            if (progressBar) progressBar.style.width = loadingProgress + '%';
            if (percentEl) percentEl.textContent = Math.floor(loadingProgress) + '%';
            
            if (tipsEl && Math.random() < 0.1) {
                tipsEl.textContent = loadingTips[Math.floor(Math.random() * loadingTips.length)];
            }
        }, 150);

        // Initialize state and update displays after a short delay
        setTimeout(() => {
            initState();
            const highScoreEl = $('highScoreDisplay');
            const bestComboEl = $('bestComboDisplay');
            if (highScoreEl) highScoreEl.textContent = state.highScore;
            if (bestComboEl) bestComboEl.textContent = state.bestCombo;
        }, 100);

        // ==================== CANVAS SETUP ====================
        function resizeCanvas() {
            canvas.width = Math.min(800, window.innerWidth - 40);
            canvas.height = Math.min(500, window.innerHeight - 280);
        }
        resizeCanvas();

        // ==================== GAME STATE ====================
        let game = {
            player: { 
                x: canvas.width / 2, 
                y: canvas.height - 50, 
                width: 40, 
                height: 40, 
                speed: 6,
                touchX: null,
                touchY: null,
                lives: 3,
                maxLives: 5,
                invincible: false,
                invincibleTimer: 0,
                powerUps: { shield: false, rapidFire: false, doubleShot: false, magnet: false },
                damageTaken: 0
            },
            bullets: [],
            enemyBullets: [],
            enemies: [],
            particles: [],
            powerUps: [],
            boss: null,
            score: 0,
            kills: 0,
            combo: 0,
            maxCombo: 0,
            comboTimer: 0,
            keys: {},
            gameOver: false,
            win: false,
            lastShot: 0,
            screenShake: 0,
            bossSpawned: false,
            gameTime: 0,
            wave: 1,
            waveKills: 0,
            waveTransition: false,
            musicPlaying: false
        };

        // ==================== LEADERBOARD SYSTEM ====================
        function getLeaderboard() {
            return safeGetJSON('spaceDefenderLeaderboard', []);
        }

        function addToLeaderboard(name, score, wave) {
            const leaderboard = getLeaderboard();
            leaderboard.push({ name, score, wave, date: new Date().toISOString() });
            leaderboard.sort((a, b) => b.score - a.score);
            const trimmed = leaderboard.slice(0, CONFIG.leaderboard.maxEntries);
            safeSetItem('spaceDefenderLeaderboard', JSON.stringify(trimmed));
            return trimmed;
        }

        function showLeaderboard() {
            const leaderboard = getLeaderboard();
            let html = '<div style="text-align:center;color:#fff;font-family:Orbitron,Arial">';
            html += '<h3 style="color:#ffff00;margin-bottom:10px">🏆 TOP 10 SCORES 🏆</h3>';
            if (leaderboard.length === 0) {
                html += '<p style="color:#888">No scores yet. Be the first!</p>';
            } else {
                leaderboard.forEach((entry, i) => {
                    const medal = i === 0 ? '🥇' : i === 1 ? '🥈' : i === 2 ? '🥉' : `${i+1}.`;
                    html += `<div style="margin:5px 0;color:${i < 3 ? '#ffff00' : '#ccc'}">${medal} ${entry.name}: ${entry.score} (Wave ${entry.wave})</div>`;
                });
            }
            html += '</div>';
            return html;
        }

        // ==================== BACKGROUND MUSIC SYSTEM ====================
        let bgmOscillator = null;
        let bgmGain = null;

        function startBackgroundMusic() {
            if (!state.soundEnabled || !audioCtx || game.musicPlaying) return;
            try {
                bgmOscillator = audioCtx.createOscillator();
                bgmGain = audioCtx.createGain();
                bgmOscillator.connect(bgmGain);
                bgmGain.connect(audioCtx.destination);
                bgmOscillator.type = 'square';
                bgmGain.gain.setValueAtTime(0.03, audioCtx.currentTime);
                
                // Simple retro melody pattern
                const notes = [262, 294, 330, 349, 392, 349, 330, 294];
                let noteIndex = 0;
                
                function playNote() {
                    if (!game.musicPlaying || !bgmOscillator) return;
                    bgmOscillator.frequency.setValueAtTime(notes[noteIndex], audioCtx.currentTime);
                    noteIndex = (noteIndex + 1) % notes.length;
                    setTimeout(playNote, 400);
                }
                
                bgmOscillator.start();
                game.musicPlaying = true;
                playNote();
            } catch(e) {
                console.warn('Background music failed:', e);
            }
        }

        function stopBackgroundMusic() {
            if (bgmOscillator) {
                try {
                    bgmOscillator.stop();
                    bgmOscillator.disconnect();
                } catch(e) {}
                bgmOscillator = null;
            }
            game.musicPlaying = false;
        }

        // ==================== AUDIO SYSTEM (Web Audio API) ====================
        let audioCtx = null;
        let audioInitFailed = false;
        
        function initAudio() {
            if (audioInitFailed || audioCtx) return;
            
            try {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                // Resume context if suspended (required for some browsers)
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume().catch(() => {});
                }
            } catch (e) {
                console.warn('Web Audio API not supported:', e);
                audioInitFailed = true;
            }
        }

        function playSound(type) {
            if (!state.soundEnabled || !audioCtx || audioCtx.state === 'closed') return;
            
            try {
                // Resume if suspended
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }
                
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
            
            switch(type) {
                case 'shoot':
                    oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(200, audioCtx.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.1);
                    break;
                case 'explosion':
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(100, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.3);
                    break;
                case 'powerup':
                    oscillator.frequency.setValueAtTime(400, audioCtx.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(800, audioCtx.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.2);
                    break;
                case 'combo':
                    oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                    oscillator.frequency.setValueAtTime(800, audioCtx.currentTime + 0.1);
                    oscillator.frequency.setValueAtTime(1000, audioCtx.currentTime + 0.2);
                    gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.3);
                    break;
                case 'boss':
                    oscillator.type = 'square';
                    oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
                    oscillator.frequency.setValueAtTime(100, audioCtx.currentTime + 0.2);
                    oscillator.frequency.setValueAtTime(150, audioCtx.currentTime + 0.4);
                    gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + 0.5);
                    break;
            }
            } catch (e) {
                // Silently fail audio - don't break the game
                console.warn('Audio playback failed:', e);
            }
        }

        // ==================== GAME MODE & DIFFICULTY ====================
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.currentMode = btn.dataset.mode;
            });
        });

        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => {
                    b.classList.remove('active');
                    b.setAttribute('aria-pressed', 'false');
                });
                btn.classList.add('active');
                btn.setAttribute('aria-pressed', 'true');
                state.currentDifficulty = btn.dataset.difficulty;
            });
        });

        // Weapon selector
        document.querySelectorAll('.weapon-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                if (btn.classList.contains('locked')) return;
                document.querySelectorAll('.weapon-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                state.currentWeapon = btn.dataset.weapon;
            });
        });

        function updateWeaponUnlocks() {
            document.querySelectorAll('.weapon-btn').forEach(btn => {
                const weapon = CONFIG.weapons[btn.dataset.weapon];
                if (game.score >= weapon.unlockScore) {
                    btn.classList.remove('locked');
                }
            });
        }

        // ==================== SOUND TOGGLE ====================
        const soundToggle = $('soundToggle');
        if (soundToggle) {
            soundToggle.addEventListener('click', () => {
                state.soundEnabled = !state.soundEnabled;
                soundToggle.textContent = state.soundEnabled ? '🔊' : '🔇';
                if (state.soundEnabled) initAudio();
            });
        }

        // ==================== SKIP GAME ====================
        const skipGameBtn = $('skipGameBtn');
        if (skipGameBtn) {
            skipGameBtn.addEventListener('click', skipToPortfolio);
        }

        function skipToPortfolio() {
            const gameContainer = $('gameContainer');
            const portfolio = $('portfolio');
            const navHeader = $('navHeader');
            const sectionIndicator = $('sectionIndicator');
            const xpDisplay = $('xpDisplay');
            
            if (gameContainer) gameContainer.classList.add('hidden');
            if (portfolio) portfolio.classList.add('visible');
            if (navHeader) navHeader.classList.add('visible');
            if (sectionIndicator) sectionIndicator.classList.add('visible');
            if (xpDisplay) xpDisplay.classList.add('visible');
            
            document.body.style.overflow = 'auto';
            
            unlockAchievement('explorer');
            addXP(25, 'Entered portfolio');
        }

        // ==================== PAUSE FUNCTIONALITY ====================
        function togglePause() {
            if (game.gameOver || game.win) return;
            state.isPaused = !state.isPaused;
            const pauseOverlay = $('pauseOverlay');
            if (pauseOverlay) {
                pauseOverlay.classList.toggle('visible', state.isPaused);
            }
        }

        const pauseOverlayEl = $('pauseOverlay');
        if (pauseOverlayEl) {
            pauseOverlayEl.addEventListener('click', togglePause);
        }

        // ==================== TOUCH CONTROLS ====================
        const leftBtn = $('leftBtn');
        const rightBtn = $('rightBtn');
        const shootBtn = $('shootBtn');

        function handleTouchStart(e, direction) {
            e.preventDefault();
            initAudio();
            if (direction === 'left') game.keys['ArrowLeft'] = true;
            if (direction === 'right') game.keys['ArrowRight'] = true;
            if (direction === 'shoot') game.keys[' '] = true;
        }

        function handleTouchEnd(e, direction) {
            e.preventDefault();
            if (direction === 'left') game.keys['ArrowLeft'] = false;
            if (direction === 'right') game.keys['ArrowRight'] = false;
            if (direction === 'shoot') game.keys[' '] = false;
        }

        leftBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'left'));
        leftBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'left'));
        rightBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'right'));
        rightBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'right'));
        shootBtn.addEventListener('touchstart', (e) => handleTouchStart(e, 'shoot'));
        shootBtn.addEventListener('touchend', (e) => handleTouchEnd(e, 'shoot'));

        // Canvas touch/mouse handlers
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            initAudio();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            game.player.touchX = touch.clientX - rect.left;
            game.player.touchY = touch.clientY - rect.top;
            game.keys[' '] = true;
        });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            game.player.touchX = touch.clientX - rect.left;
            game.player.touchY = touch.clientY - rect.top;
        });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            game.player.touchX = null;
            game.player.touchY = null;
            game.keys[' '] = false;
        });

        if (!isTouchDevice) {
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                game.player.touchX = e.clientX - rect.left;
                game.player.touchY = e.clientY - rect.top;
            });

            canvas.addEventListener('click', () => {
                initAudio();
                game.keys[' '] = true;
                setTimeout(() => game.keys[' '] = false, 100);
            });
        }

        // Keyboard controls
        document.addEventListener('keydown', e => {
            game.keys[e.key] = true;
            if (e.key === ' ') { e.preventDefault(); initAudio(); }
            if (e.key === 'p' || e.key === 'P') togglePause();
            if (e.key === 'Escape') skipToPortfolio();
            
            // Konami Code detection
            if (e.key === state.konamiCode[state.konamiIndex]) {
                state.konamiIndex++;
                if (state.konamiIndex === state.konamiCode.length) {
                    activateEasterEgg();
                    state.konamiIndex = 0;
                }
            } else {
                state.konamiIndex = 0;
            }
        });
        document.addEventListener('keyup', e => game.keys[e.key] = false);

        // ==================== EASTER EGG ====================
        function activateEasterEgg() {
            unlockAchievement('konami');
            document.body.classList.add('easter-egg-active');
            $('easterEggText').classList.add('show');
            playSound('powerup');
            
            // Unlock all weapons
            document.querySelectorAll('.weapon-btn').forEach(btn => btn.classList.remove('locked'));
            
            // Give bonus power-ups
            game.player.powerUps.shield = true;
            game.player.powerUps.rapidFire = true;
            game.player.powerUps.doubleShot = true;
            
            setTimeout(() => {
                document.body.classList.remove('easter-egg-active');
                $('easterEggText').classList.remove('show');
            }, 5000);
        }

        // ==================== GAME CLASSES ====================
        class Bullet {
            constructor(x, y, angle = -Math.PI/2) {
                const weapon = CONFIG.weapons[state.currentWeapon];
                this.x = x;
                this.y = y;
                this.width = state.currentWeapon === 'missile' ? 8 : 4;
                this.height = state.currentWeapon === 'missile' ? 20 : 15;
                this.speed = state.currentWeapon === 'missile' ? 8 : 12;
                this.damage = weapon.damage;
                this.color = weapon.color;
                this.angle = angle;
                this.vx = Math.cos(angle) * this.speed;
                this.vy = Math.sin(angle) * this.speed;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
            }

            draw() {
                ctx.save();
                ctx.translate(this.x + this.width/2, this.y + this.height/2);
                ctx.rotate(this.angle + Math.PI/2);
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                
                if (state.currentWeapon === 'missile') {
                    // Missile shape
                    ctx.beginPath();
                    ctx.moveTo(0, -this.height/2);
                    ctx.lineTo(-this.width/2, this.height/2);
                    ctx.lineTo(this.width/2, this.height/2);
                    ctx.closePath();
                    ctx.fill();
                } else {
                    ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
                }
                ctx.shadowBlur = 0;
                ctx.restore();
            }
        }

        // ==================== ENEMY BULLET CLASS ====================
        class EnemyBullet {
            constructor(x, y, targetX, targetY, speed = 4) {
                this.x = x;
                this.y = y;
                this.width = 6;
                this.height = 6;
                this.speed = speed;
                const angle = Math.atan2(targetY - y, targetX - x);
                this.vx = Math.cos(angle) * this.speed;
                this.vy = Math.sin(angle) * this.speed;
                this.color = '#ff4444';
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 15;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.width/2, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        class Enemy {
            constructor(isBoss = false, waveMultiplier = 1) {
                const diff = CONFIG.difficulties[state.currentDifficulty];
                this.isBoss = isBoss;
                this.x = isBoss ? canvas.width/2 - 50 : Math.random() * (canvas.width - 40);
                this.y = isBoss ? -120 : -40;
                this.width = isBoss ? 100 : 40;
                this.height = isBoss ? 100 : 40;
                this.speed = (isBoss ? 1 : diff.enemySpeed + Math.random() * 1.5) * (1 + (waveMultiplier - 1) * 0.1);
                this.health = (isBoss ? 30 : diff.enemyHealth) * waveMultiplier;
                this.maxHealth = this.health;
                this.canShoot = isBoss || (diff.enemyShootChance > 0 && Math.random() < 0.3);
                this.shootTimer = 0;
                this.shootRate = isBoss ? diff.bossShootRate : 180;
                
                // Enemy types with different behaviors
                this.enemyType = Math.floor(Math.random() * 4); // 0-3 types
                const enemyColors = {
                    0: '#ff00ff', // Magenta - standard
                    1: '#00ff88', // Green - fast
                    2: '#ffaa00', // Orange - tank
                    3: '#00ffff'  // Cyan - zigzag
                };
                this.color = isBoss ? '#ff0000' : enemyColors[this.enemyType];
                
                // Adjust stats based on type
                if (!isBoss) {
                    if (this.enemyType === 1) { // Fast type
                        this.speed *= 1.5;
                        this.health = Math.max(1, this.health - 1);
                        this.canShoot = false;
                    } else if (this.enemyType === 2) { // Tank type
                        this.speed *= 0.7;
                        this.health += 2;
                        this.maxHealth = this.health;
                        this.width = 50;
                        this.height = 50;
                        this.canShoot = true;
                    } else if (this.enemyType === 3) { // Zigzag - shooter
                        this.canShoot = true;
                        this.shootRate = 150;
                    }
                }
                this.angle = 0;
                this.movePattern = Math.random();
            }

            update() {
                this.y += this.speed;
                this.angle += 0.05;
                this.shootTimer++;
                
                if (this.isBoss) {
                    // Boss movement pattern
                    this.x += Math.sin(this.y * 0.02) * 3;
                    this.x = Math.max(0, Math.min(canvas.width - this.width, this.x));
                    
                    // Boss shooting - multiple patterns
                    if (this.shootTimer >= this.shootRate && this.y > 20) {
                        this.shoot();
                        this.shootTimer = 0;
                    }
                } else {
                    // Regular enemy movement based on type
                    if (this.enemyType === 3) { // Zigzag type
                        this.x += Math.sin(this.y * 0.08) * 4;
                    } else if (this.movePattern < 0.33) {
                        this.x += Math.sin(this.y * 0.02) * 2;
                    } else if (this.movePattern < 0.66) {
                        this.x += Math.cos(this.y * 0.03) * 3;
                    }
                    
                    // Enemy shooting
                    if (this.canShoot && this.shootTimer >= this.shootRate && this.y > 50 && this.y < canvas.height - 100) {
                        const diff = CONFIG.difficulties[state.currentDifficulty];
                        if (Math.random() < diff.enemyShootChance * 10) {
                            this.shoot();
                            this.shootTimer = 0;
                        }
                    }
                }
            }

            shoot() {
                const playerCenterX = game.player.x + game.player.width / 2;
                const playerCenterY = game.player.y + game.player.height / 2;
                
                if (this.isBoss) {
                    // Boss shoots multiple bullets in a pattern
                    for (let i = -2; i <= 2; i++) {
                        const spreadX = playerCenterX + i * 50;
                        game.enemyBullets.push(new EnemyBullet(
                            this.x + this.width/2,
                            this.y + this.height,
                            spreadX,
                            playerCenterY,
                            3
                        ));
                    }
                    playSound('shoot');
                } else {
                    game.enemyBullets.push(new EnemyBullet(
                        this.x + this.width/2,
                        this.y + this.height,
                        playerCenterX,
                        playerCenterY,
                        4
                    ));
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x + this.width/2, this.y + this.height/2);
                
                if (!this.isBoss) ctx.rotate(this.angle);

                ctx.fillStyle = this.color;
                ctx.shadowBlur = this.isBoss ? 50 : 25;
                ctx.shadowColor = this.color;
                
                if (this.isBoss) {
                    // Boss design - more complex
                    ctx.beginPath();
                    ctx.arc(0, 0, this.width/2, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Boss eyes
                    ctx.fillStyle = '#000';
                    ctx.beginPath();
                    ctx.arc(-20, -10, 10, 0, Math.PI * 2);
                    ctx.arc(20, -10, 10, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Evil grin
                    ctx.strokeStyle = '#000';
                    ctx.lineWidth = 4;
                    ctx.beginPath();
                    ctx.arc(0, 10, 30, 0.2, Math.PI - 0.2);
                    ctx.stroke();
                    
                    // Horns
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.moveTo(-30, -30);
                    ctx.lineTo(-40, -60);
                    ctx.lineTo(-20, -35);
                    ctx.closePath();
                    ctx.fill();
                    ctx.beginPath();
                    ctx.moveTo(30, -30);
                    ctx.lineTo(40, -60);
                    ctx.lineTo(20, -35);
                    ctx.closePath();
                    ctx.fill();
                } else {
                    // Regular enemy with type-based appearance
                    if (this.enemyType === 2) { // Tank - square-ish
                        ctx.beginPath();
                        ctx.roundRect(-this.width/2, -this.height/2, this.width, this.height, 8);
                        ctx.fill();
                    } else {
                        ctx.beginPath();
                        ctx.arc(0, 0, this.width/2, 0, Math.PI * 2);
                        ctx.fill();
                    }

                    // Eyes - different based on type
                    ctx.fillStyle = '#000';
                    ctx.beginPath();
                    if (this.enemyType === 1) { // Fast - angry eyes
                        ctx.ellipse(-8, -5, 5, 3, -0.3, 0, Math.PI * 2);
                        ctx.ellipse(8, -5, 5, 3, 0.3, 0, Math.PI * 2);
                    } else {
                        ctx.arc(-8, -5, 4, 0, Math.PI * 2);
                        ctx.arc(8, -5, 4, 0, Math.PI * 2);
                    }
                    ctx.fill();

                    // Mouth - type based
                    ctx.strokeStyle = '#000';
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    if (this.enemyType === 1) { // Fast - angry mouth
                        ctx.moveTo(-10, 8);
                        ctx.lineTo(10, 8);
                        ctx.stroke();
                    } else if (this.enemyType === 2) { // Tank - grumpy
                        ctx.arc(0, 8, 8, 0.3, Math.PI - 0.3);
                        ctx.stroke();
                    } else {
                        ctx.arc(0, 5, 8, 0, Math.PI);
                        ctx.stroke();
                    }
                }

                ctx.shadowBlur = 0;
                ctx.restore();

                // Health bar
                const barWidth = this.width;
                const barHeight = this.isBoss ? 8 : 5;
                const barY = this.y - (this.isBoss ? 20 : 12);
                
                ctx.fillStyle = 'rgba(255, 0, 0, 0.7)';
                ctx.fillRect(this.x, barY, barWidth, barHeight);
                ctx.fillStyle = this.isBoss ? '#ff6600' : 'rgba(0, 255, 0, 0.9)';
                ctx.fillRect(this.x, barY, barWidth * (this.health / this.maxHealth), barHeight);
            }
        }

        class PowerUp {
            constructor(x, y, forceType = null) {
                this.x = x;
                this.y = y;
                this.width = 25;
                this.height = 25;
                this.speed = 2;
                const types = Object.keys(CONFIG.powerUpTypes);
                this.type = forceType || types[Math.floor(Math.random() * types.length)];
                const config = CONFIG.powerUpTypes[this.type];
                this.color = config.color;
                this.icon = config.icon;
                this.duration = config.duration;
                this.angle = 0;
            }

            update() {
                this.y += this.speed;
                this.angle += 0.1;
                
                // Magnet effect - attract to player
                if (game.player.powerUps.magnet) {
                    const dx = (game.player.x + game.player.width/2) - (this.x + this.width/2);
                    const dy = (game.player.y + game.player.height/2) - (this.y + this.height/2);
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < 200) {
                        this.x += (dx / dist) * 5;
                        this.y += (dy / dist) * 5;
                    }
                }
            }

            draw() {
                ctx.save();
                ctx.translate(this.x + this.width/2, this.y + this.height/2);
                ctx.rotate(this.angle);
                
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 20;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(0, 0, this.width/2, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
                ctx.restore();
                
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(this.icon, this.x + this.width/2, this.y + this.height/2);
            }

            apply() {
                switch(this.type) {
                    case 'health':
                        if (game.player.lives < game.player.maxLives) {
                            game.player.lives++;
                            playSound('powerup');
                        }
                        break;
                    case 'bomb':
                        // Clear all enemies on screen
                        game.enemies.forEach(enemy => {
                            if (!enemy.isBoss) {
                                for (let i = 0; i < 10; i++) {
                                    game.particles.push(new Particle(
                                        enemy.x + enemy.width/2,
                                        enemy.y + enemy.height/2,
                                        enemy.color
                                    ));
                                }
                                game.score += 50;
                            }
                        });
                        game.enemies = game.enemies.filter(e => e.isBoss);
                        game.enemyBullets = [];
                        game.screenShake = 20;
                        playSound('explosion');
                        unlockAchievement('bomb_clear');
                        break;
                    default:
                        // Timed power-ups
                        game.player.powerUps[this.type] = true;
                        if (this.duration > 0) {
                            setTimeout(() => {
                                game.player.powerUps[this.type] = false;
                            }, this.duration);
                        }
                        playSound('powerup');
                }
            }
        }

        class Particle {
            constructor(x, y, color, size = null) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 10;
                this.vy = (Math.random() - 0.5) * 10;
                this.life = 1;
                this.color = color;
                this.size = size || Math.random() * 5 + 2;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                this.life -= 0.025;
                this.vy += 0.15;
                this.vx *= 0.98;
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.life;
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size * this.life, 0, Math.PI * 2);
                ctx.fill();
                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;
            }
        }

        // ==================== GAME FUNCTIONS ====================
        function spawnEnemy() {
            if (game.waveTransition) return;
            
            const diff = CONFIG.difficulties[state.currentDifficulty];
            const waveMultiplier = 1 + (game.wave - 1) * 0.2;
            const adjustedSpawnRate = diff.spawnRate * (1 + (game.wave - 1) * 0.1);
            const adjustedMaxEnemies = Math.min(diff.maxEnemies + game.wave, 20);
            
            if (Math.random() < adjustedSpawnRate && game.enemies.length < adjustedMaxEnemies && !game.boss) {
                game.enemies.push(new Enemy(false, waveMultiplier));
            }
        }

        function advanceWave() {
            if (game.wave >= CONFIG.MAX_WAVES) return;
            
            game.waveTransition = true;
            game.wave++;
            game.waveKills = 0;
            
            // Achievement checks
            if (game.wave >= 5) unlockAchievement('wave_5');
            if (game.wave >= 10) unlockAchievement('wave_10');
            
            // Show wave notification
            showAchievement('🌊', `WAVE ${game.wave}`, 0);
            
            // Clear remaining enemies
            game.enemies = game.enemies.filter(e => e.isBoss);
            
            setTimeout(() => {
                game.waveTransition = false;
            }, 2000);
        }

        function spawnBoss() {
            if (game.bossSpawned) return;
            if (game.kills > 0 && game.kills % CONFIG.BOSS_SPAWN_KILLS === 0) {
                game.bossSpawned = true;
                
                // Show boss warning
                $('bossWarning').classList.add('show');
                playSound('boss');
                
                // Screen shake
                $('gameWrapper').classList.add('screen-shake');
                setTimeout(() => $('gameWrapper').classList.remove('screen-shake'), 500);
                
                setTimeout(() => {
                    $('bossWarning').classList.remove('show');
                    game.boss = new Enemy(true);
                    game.enemies.push(game.boss);
                }, 2000);
            }
        }

        function spawnPowerUp(x, y) {
            if (Math.random() < 0.15) {
                game.powerUps.push(new PowerUp(x, y));
            }
        }

        function shootBullet() {
            if (!game.keys[' ']) return;
            
            const weapon = CONFIG.weapons[state.currentWeapon];
            const fireRate = game.player.powerUps.rapidFire ? weapon.fireRate * 0.5 : weapon.fireRate;
            
            if (Date.now() - game.lastShot > fireRate) {
                const bulletX = game.player.x + game.player.width / 2 - 2;
                
                if (weapon.bullets === 3 || game.player.powerUps.doubleShot) {
                    // Spread shot
                    game.bullets.push(new Bullet(bulletX - 15, game.player.y, -Math.PI/2 - 0.15));
                    game.bullets.push(new Bullet(bulletX, game.player.y, -Math.PI/2));
                    game.bullets.push(new Bullet(bulletX + 15, game.player.y, -Math.PI/2 + 0.15));
                } else {
                    game.bullets.push(new Bullet(bulletX, game.player.y));
                }
                
                playSound('shoot');
                game.lastShot = Date.now();
            }
        }

        function updateCombo() {
            if (game.comboTimer > 0) {
                game.comboTimer--;
            } else if (game.combo > 0) {
                game.combo = 0;
            }
        }

        function addCombo() {
            game.combo++;
            game.comboTimer = 90; // 1.5 seconds at 60fps
            
            if (game.combo > game.maxCombo) {
                game.maxCombo = game.combo;
                if (game.maxCombo > state.bestCombo) {
                    state.bestCombo = game.maxCombo;
                    localStorage.setItem('spaceDefenderBestCombo', state.bestCombo);
                    $('bestComboDisplay').textContent = state.bestCombo;
                }
            }
            
            // Show combo popup
            if (game.combo >= 3) {
                $('gameCombo').textContent = `COMBO x${game.combo}!`;
                $('gameCombo').classList.add('show');
                playSound('combo');
                
                setTimeout(() => $('gameCombo').classList.remove('show'), 800);
                
                // Achievements
                if (game.combo >= 5) unlockAchievement('combo_5');
                if (game.combo >= 10) unlockAchievement('combo_10');
                
                // Bonus XP for combos
                addXP(CONFIG.XP_PER_COMBO * Math.floor(game.combo / 3));
            }
        }

        function checkCollisions() {
            // Bullet-Enemy collisions
            game.bullets.forEach((bullet, bIndex) => {
                game.enemies.forEach((enemy, eIndex) => {
                    if (bullet.x < enemy.x + enemy.width &&
                        bullet.x + bullet.width > enemy.x &&
                        bullet.y < enemy.y + enemy.height &&
                        bullet.y + bullet.height > enemy.y) {

                        // Particles explosion
                        const particleCount = enemy.isBoss ? 40 : 20;
                        for (let i = 0; i < particleCount; i++) {
                            game.particles.push(new Particle(
                                enemy.x + enemy.width/2, 
                                enemy.y + enemy.height/2, 
                                enemy.color,
                                enemy.isBoss ? Math.random() * 8 + 4 : null
                            ));
                        }

                        enemy.health -= bullet.damage;
                        game.bullets.splice(bIndex, 1);
                        
                        // Screen shake on hit
                        game.screenShake = Math.min(game.screenShake + 2, 8);

                        if (enemy.health <= 0) {
                            playSound('explosion');
                            spawnPowerUp(enemy.x, enemy.y);
                            
                            const diff = CONFIG.difficulties[state.currentDifficulty];
                            const scoreGain = enemy.isBoss ? 500 : 100;
                            game.score += Math.floor(scoreGain * diff.scoreMultiplier * (1 + game.combo * 0.1) * game.wave);
                            
                            if (!enemy.isBoss) {
                                game.kills++;
                                game.waveKills++;
                                addCombo();
                                addXP(CONFIG.XP_PER_KILL);
                                
                                // First kill achievement
                                if (game.kills === 1) unlockAchievement('first_kill');
                                
                                // Check wave advancement
                                if (game.waveKills >= CONFIG.WAVE_KILLS_TO_ADVANCE && !game.waveTransition) {
                                    advanceWave();
                                }
                            } else {
                                // Boss defeated
                                unlockAchievement('boss_killer');
                                addXP(100);
                                game.boss = null;
                                game.bossSpawned = false;
                                
                                // Boss rush mode: spawn next boss
                                if (state.currentMode === 'boss') {
                                    setTimeout(spawnBoss, 2000);
                                }
                            }
                            
                            game.enemies.splice(eIndex, 1);

                            // Update high score
                            if (game.score > state.highScore) {
                                state.highScore = game.score;
                                localStorage.setItem('spaceDefenderHighScore', state.highScore);
                                $('highScoreDisplay').textContent = state.highScore;
                            }

                            // Update weapon unlocks
                            updateWeaponUnlocks();

                            // Win condition
                            if (state.currentMode === 'classic' && game.kills >= CONFIG.GAME_WIN_KILLS) {
                                game.win = true;
                                
                                // Speed demon achievement
                                if (game.gameTime < 45000) unlockAchievement('speedrun');
                                
                                // Untouchable achievement
                                if (game.player.damageTaken === 0) unlockAchievement('no_damage');
                            }

                            // Spawn boss check
                            spawnBoss();
                        }
                    }
                });
            });

            // Enemy bullets hitting player
            if (!game.player.powerUps.shield && !game.player.invincible) {
                game.enemyBullets.forEach((bullet, bIndex) => {
                    if (game.player.x < bullet.x + bullet.width &&
                        game.player.x + game.player.width > bullet.x &&
                        game.player.y < bullet.y + bullet.height &&
                        game.player.y + game.player.height > bullet.y) {
                        
                        game.enemyBullets.splice(bIndex, 1);
                        damagePlayer();
                    }
                });
            }

            // PowerUp collection
            game.powerUps.forEach((powerUp, pIndex) => {
                if (game.player.x < powerUp.x + powerUp.width &&
                    game.player.x + game.player.width > powerUp.x &&
                    game.player.y < powerUp.y + powerUp.height &&
                    game.player.y + game.player.height > powerUp.y) {
                    
                    powerUp.apply();
                    game.powerUps.splice(pIndex, 1);
                }
            });

            // Player-Enemy collision
            if (!game.player.powerUps.shield && !game.player.invincible) {
                game.enemies.forEach((enemy, eIndex) => {
                    if (game.player.x < enemy.x + enemy.width &&
                        game.player.x + game.player.width > enemy.x &&
                        game.player.y < enemy.y + enemy.height &&
                        game.player.y + game.player.height > enemy.y) {
                        
                        damagePlayer();
                        
                        // Remove the enemy that hit us
                        if (!enemy.isBoss) {
                            game.enemies.splice(eIndex, 1);
                        }
                    }
                });
            }
            
            // Update invincibility timer
            if (game.player.invincible) {
                game.player.invincibleTimer--;
                if (game.player.invincibleTimer <= 0) {
                    game.player.invincible = false;
                }
            }
        }

        function damagePlayer() {
            game.player.lives--;
            game.player.damageTaken++;
            game.combo = 0;
            playSound('explosion');
            
            // Screen shake on damage
            game.screenShake = 15;
            
            // Create damage particles
            for (let i = 0; i < 15; i++) {
                game.particles.push(new Particle(
                    game.player.x + game.player.width/2,
                    game.player.y + game.player.height/2,
                    '#ff0000'
                ));
            }
            
            // Make player temporarily invincible
            game.player.invincible = true;
            game.player.invincibleTimer = 120; // 2 seconds at 60fps
            
            if (game.player.lives <= 0) {
                if (state.currentMode === 'survival') {
                    if (game.gameTime > 60000) unlockAchievement('survivor');
                }
                game.gameOver = true;
                stopBackgroundMusic();
            }
        }

        function update() {
            if (state.isPaused) return;
            
            game.gameTime += 16.67; // Approximate ms per frame
            updateCombo();

            // Screen shake decay
            if (game.screenShake > 0) game.screenShake *= 0.9;

            // Touch/Mouse movement
            if (game.player.touchX !== null) {
                const targetX = game.player.touchX - game.player.width / 2;
                const dx = targetX - game.player.x;
                game.player.x += dx * 0.15;

                if (game.player.touchY !== null && game.player.touchY > canvas.height / 2) {
                    const targetY = game.player.touchY - game.player.height / 2;
                    const dy = targetY - game.player.y;
                    game.player.y += dy * 0.15;
                }
            }

            // Keyboard movement
            if (game.keys['ArrowLeft'] && game.player.x > 0) {
                game.player.x -= game.player.speed;
            }
            if (game.keys['ArrowRight'] && game.player.x < canvas.width - game.player.width) {
                game.player.x += game.player.speed;
            }
            if (game.keys['ArrowUp'] && game.player.y > canvas.height / 2) {
                game.player.y -= game.player.speed;
            }
            if (game.keys['ArrowDown'] && game.player.y < canvas.height - game.player.height) {
                game.player.y += game.player.speed;
            }

            // Clamp player position
            game.player.x = Math.max(0, Math.min(canvas.width - game.player.width, game.player.x));
            game.player.y = Math.max(canvas.height / 2, Math.min(canvas.height - game.player.height, game.player.y));

            shootBullet();
            
            if (state.currentMode !== 'boss' || game.boss) {
                spawnEnemy();
            }

            // Update game objects
            game.bullets = game.bullets.filter(bullet => {
                bullet.update();
                return bullet.y > -20 && bullet.y < canvas.height + 20 && 
                       bullet.x > -20 && bullet.x < canvas.width + 20;
            });

            // Update enemy bullets
            game.enemyBullets = game.enemyBullets.filter(bullet => {
                bullet.update();
                return bullet.y > -20 && bullet.y < canvas.height + 20 && 
                       bullet.x > -20 && bullet.x < canvas.width + 20;
            });

            game.enemies = game.enemies.filter(enemy => {
                enemy.update();
                if (enemy.y > canvas.height + 50) {
                    if (enemy.isBoss) {
                        game.boss = null;
                        game.bossSpawned = false;
                    }
                    return false;
                }
                return true;
            });

            game.powerUps = game.powerUps.filter(powerUp => {
                powerUp.update();
                return powerUp.y < canvas.height + 50;
            });

            game.particles = game.particles.filter(particle => {
                particle.update();
                return particle.life > 0;
            });

            checkCollisions();
        }

        function draw() {
            // Apply screen shake
            ctx.save();
            if (game.screenShake > 0.5) {
                ctx.translate(
                    (Math.random() - 0.5) * game.screenShake,
                    (Math.random() - 0.5) * game.screenShake
                );
            }

            // Clear with trail effect
            ctx.fillStyle = 'rgba(5, 5, 10, 0.25)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw particles (behind everything)
            game.particles.forEach(particle => particle.draw());

            // Draw player
            ctx.save();
            ctx.translate(game.player.x + game.player.width / 2, game.player.y + game.player.height / 2);

            // Shield effect
            if (game.player.powerUps.shield) {
                ctx.strokeStyle = '#00ff00';
                ctx.lineWidth = 3;
                ctx.shadowBlur = 20;
                ctx.shadowColor = '#00ff00';
                ctx.beginPath();
                ctx.arc(0, 0, 35, 0, Math.PI * 2);
                ctx.stroke();
                ctx.shadowBlur = 0;
            }

            // Player ship with invincibility flashing
            const shipColor = game.player.powerUps.rapidFire ? '#ff6600' : '#00ffff';
            
            // Flash when invincible
            if (game.player.invincible && Math.floor(game.player.invincibleTimer / 5) % 2 === 0) {
                ctx.globalAlpha = 0.3;
            }
            
            ctx.fillStyle = shipColor;
            ctx.shadowBlur = 30;
            ctx.shadowColor = shipColor;
            ctx.beginPath();
            ctx.moveTo(0, -25);
            ctx.lineTo(-18, 18);
            ctx.lineTo(0, 12);
            ctx.lineTo(18, 18);
            ctx.closePath();
            ctx.fill();

            // Cockpit
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(0, -5, 6, 0, Math.PI * 2);
            ctx.fill();

            ctx.shadowBlur = 0;
            ctx.globalAlpha = 1; // Reset alpha
            ctx.restore();

            // Engine flames
            const flameHeight = 10 + Math.random() * 8;
            const flameColor = game.player.powerUps.rapidFire ? '#00ff00' : '#ff6600';
            ctx.fillStyle = flameColor;
            ctx.beginPath();
            ctx.moveTo(game.player.x + game.player.width / 2, game.player.y + game.player.height - 8);
            ctx.lineTo(game.player.x + 10, game.player.y + game.player.height + flameHeight);
            ctx.lineTo(game.player.x + game.player.width / 2, game.player.y + game.player.height + flameHeight - 8);
            ctx.lineTo(game.player.x + 30, game.player.y + game.player.height + flameHeight);
            ctx.closePath();
            ctx.fill();

            // Draw game elements
            game.bullets.forEach(bullet => bullet.draw());
            game.enemyBullets.forEach(bullet => bullet.draw());
            game.enemies.forEach(enemy => enemy.draw());
            game.powerUps.forEach(powerUp => powerUp.draw());

            // Draw HUD
            ctx.fillStyle = '#00ffff';
            ctx.font = 'bold 18px Orbitron, Arial';
            ctx.textAlign = 'left';
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#00ffff';
            ctx.fillText(`SCORE: ${game.score}`, 15, 28);
            ctx.fillText(`KILLS: ${game.kills}/${CONFIG.GAME_WIN_KILLS}`, 15, 52);
            
            // Wave display
            ctx.fillStyle = '#00ff88';
            ctx.fillText(`WAVE: ${game.wave}`, 15, 76);
            
            // Combo display
            if (game.combo >= 2) {
                ctx.fillStyle = '#ffff00';
                ctx.fillText(`COMBO: x${game.combo}`, 15, 100);
            }
            
            // Score multiplier display
            const diff = CONFIG.difficulties[state.currentDifficulty];
            const multiplier = (diff.scoreMultiplier * (1 + game.combo * 0.1) * game.wave).toFixed(1);
            ctx.fillStyle = '#ff00ff';
            ctx.font = 'bold 14px Orbitron, Arial';
            ctx.fillText(`MULT: x${multiplier}`, 15, game.combo >= 2 ? 120 : 100);
            
            // Lives display
            ctx.fillStyle = '#ff4444';
            ctx.font = 'bold 16px Arial';
            const livesY = game.combo >= 2 ? 140 : 120;
            let livesText = '';
            for (let i = 0; i < game.player.lives; i++) livesText += '❤️';
            for (let i = game.player.lives; i < game.player.maxLives; i++) livesText += '🖤';
            ctx.fillText(livesText, 15, livesY);
            
            ctx.shadowBlur = 0;

            // Progress bar
            const progressWidth = Math.min(200, canvas.width * 0.3);
            const progressHeight = 18;
            const progressX = canvas.width - progressWidth - 15;
            const progressY = 12;
            
            ctx.strokeStyle = '#00ffff';
            ctx.lineWidth = 2;
            ctx.strokeRect(progressX, progressY, progressWidth, progressHeight);
            
            const progress = Math.min(game.kills / CONFIG.GAME_WIN_KILLS, 1);
            const gradient = ctx.createLinearGradient(progressX, 0, progressX + progressWidth, 0);
            gradient.addColorStop(0, '#00ffff');
            gradient.addColorStop(0.5, '#ff00ff');
            gradient.addColorStop(1, '#ffff00');
            ctx.fillStyle = gradient;
            ctx.fillRect(progressX + 2, progressY + 2, (progressWidth - 4) * progress, progressHeight - 4);

            // Mini-map (radar)
            const mapSize = 80;
            const mapX = canvas.width - mapSize - 15;
            const mapY = canvas.height - mapSize - 15;
            const mapScale = mapSize / Math.max(canvas.width, canvas.height);
            
            ctx.fillStyle = 'rgba(0, 0, 0, 0.6)';
            ctx.strokeStyle = '#00ffff';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.arc(mapX + mapSize/2, mapY + mapSize/2, mapSize/2, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Player on mini-map
            ctx.fillStyle = '#00ff00';
            ctx.beginPath();
            ctx.arc(
                mapX + (game.player.x + game.player.width/2) * mapScale,
                mapY + (game.player.y + game.player.height/2) * mapScale,
                3, 0, Math.PI * 2
            );
            ctx.fill();
            
            // Enemies on mini-map
            game.enemies.forEach(enemy => {
                ctx.fillStyle = enemy.isBoss ? '#ff0000' : enemy.color;
                ctx.beginPath();
                ctx.arc(
                    mapX + (enemy.x + enemy.width/2) * mapScale,
                    mapY + (enemy.y + enemy.height/2) * mapScale,
                    enemy.isBoss ? 4 : 2, 0, Math.PI * 2
                );
                ctx.fill();
            });
            
            // Power-ups on mini-map
            game.powerUps.forEach(pu => {
                ctx.fillStyle = '#ffff00';
                ctx.beginPath();
                ctx.arc(
                    mapX + (pu.x + pu.width/2) * mapScale,
                    mapY + (pu.y + pu.height/2) * mapScale,
                    2, 0, Math.PI * 2
                );
                ctx.fill();
            });

            // Power-up indicators
            let powerUpY = game.combo >= 2 ? 160 : 140;
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'left';
            Object.entries(game.player.powerUps).forEach(([type, active]) => {
                if (active) {
                    const config = CONFIG.powerUpTypes[type];
                    if (config) {
                        ctx.fillStyle = config.color;
                        ctx.fillText(`${config.icon} ${type.toUpperCase()}`, 15, powerUpY);
                        powerUpY += 18;
                    }
                }
            });

            // Wave transition overlay
            if (game.waveTransition) {
                ctx.fillStyle = 'rgba(0, 255, 136, 0.3)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#00ff88';
                ctx.font = 'bold 36px Orbitron, Arial';
                ctx.textAlign = 'center';
                ctx.shadowBlur = 30;
                ctx.shadowColor = '#00ff88';
                ctx.fillText(`WAVE ${game.wave}`, canvas.width/2, canvas.height/2);
                ctx.shadowBlur = 0;
            }

            ctx.restore();
        }

        function gameLoop() {
            if (game.gameOver) {
                ctx.fillStyle = 'rgba(255, 0, 0, 0.85)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 48px Orbitron, Arial';
                ctx.textAlign = 'center';
                ctx.shadowBlur = 30;
                ctx.shadowColor = '#ff0000';
                ctx.fillText('GAME OVER!', canvas.width / 2, canvas.height / 2 - 60);
                ctx.font = 'bold 20px Rajdhani, Arial';
                ctx.fillText(`Score: ${game.score} | Wave: ${game.wave} | Combo: x${game.maxCombo}`, canvas.width / 2, canvas.height / 2 - 10);
                ctx.fillText('Tap/Click to Retry', canvas.width / 2, canvas.height / 2 + 30);
                ctx.font = '16px Arial';
                ctx.fillText(`High Score: ${state.highScore}`, canvas.width / 2, canvas.height / 2 + 60);
                
                // Show mini leaderboard
                const leaderboard = getLeaderboard();
                if (leaderboard.length > 0) {
                    ctx.font = '12px Arial';
                    ctx.fillStyle = '#ffff00';
                    ctx.fillText('🏆 TOP 3 SCORES:', canvas.width / 2, canvas.height / 2 + 90);
                    ctx.fillStyle = '#fff';
                    leaderboard.slice(0, 3).forEach((entry, i) => {
                        const medal = i === 0 ? '🥇' : i === 1 ? '🥈' : '🥉';
                        ctx.fillText(`${medal} ${entry.score}`, canvas.width / 2, canvas.height / 2 + 110 + i * 18);
                    });
                }
                ctx.shadowBlur = 0;

                // Add to leaderboard
                if (!game.addedToLeaderboard) {
                    game.addedToLeaderboard = true;
                    const playerName = 'Player';
                    addToLeaderboard(playerName, game.score, game.wave);
                }

                canvas.onclick = () => location.reload();
                canvas.ontouchstart = () => location.reload();
                return;
            }

            if (game.win) {
                ctx.fillStyle = 'rgba(0, 255, 100, 0.85)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#fff';
                ctx.font = 'bold 48px Orbitron, Arial';
                ctx.textAlign = 'center';
                ctx.shadowBlur = 30;
                ctx.shadowColor = '#00ff00';
                ctx.fillText('🏆 VICTORY! 🏆', canvas.width / 2, canvas.height / 2 - 40);
                ctx.font = 'bold 24px Rajdhani, Arial';
                ctx.fillText(`Final Score: ${game.score}`, canvas.width / 2, canvas.height / 2 + 10);
                ctx.fillText(`Reached Wave: ${game.wave} | Best Combo: x${game.maxCombo}`, canvas.width / 2, canvas.height / 2 + 45);
                ctx.font = '18px Arial';
                ctx.fillText('Entering Portfolio...', canvas.width / 2, canvas.height / 2 + 85);
                ctx.shadowBlur = 0;

                addXP(game.score / 10);
                stopBackgroundMusic();

                // Add to leaderboard
                if (!game.addedToLeaderboard) {
                    game.addedToLeaderboard = true;
                    addToLeaderboard('Player', game.score, game.wave);
                }
                
                setTimeout(() => {
                    skipToPortfolio();
                }, 2500);
                return;
            }

            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        // ==================== RESUME PDF GENERATION ====================
        async function generateResumePDF() {
            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Header
                doc.setFontSize(28);
                doc.setTextColor(0, 255, 255);
                doc.text('KARTHIK M', 105, 20, { align: 'center' });
                
                doc.setFontSize(14);
                doc.setTextColor(100, 100, 100);
                doc.text('Software Developer | AI & ML Expert', 105, 28, { align: 'center' });
                
                // Contact
                doc.setFontSize(10);
                doc.setTextColor(0, 0, 0);
                doc.text('iammrkarthik2002@gmail.com | +91 7019880061 | Bangalore', 105, 35, { align: 'center' });
                doc.text('linkedin.com/in/karthik-m-9262a02b4 | github.com/Karthik77-kk', 105, 40, { align: 'center' });
                
                doc.setDrawColor(0, 255, 255);
                doc.line(20, 43, 190, 43);
                
                let y = 50;
                
                // Summary
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('PROFESSIONAL SUMMARY', 20, y);
                doc.line(20, y + 1, 80, y + 1);
                y += 6;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                const summary = doc.splitTextToSize('Software Developer with expertise in Python, ML, AWS Cloud. Currently at Eurofins IT Solutions. Strong in AI/ML, computer vision, IoT.', 170);
                doc.text(summary, 20, y);
                y += summary.length * 5 + 5;
                
                // Experience
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('EXPERIENCE', 20, y);
                doc.line(20, y + 1, 60, y + 1);
                y += 6;
                doc.setFontSize(11);
                doc.text('Software Developer - Eurofins IT Solutions', 20, y);
                y += 5;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('Present | Enterprise software solutions', 20, y);
                y += 8;
                
                doc.setFont(undefined, 'bold');
                doc.setFontSize(11);
                doc.text('Data Science Intern - Prinston Smart', 20, y);
                y += 5;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('Nov 2024 - Jan 2025 | 100k+ datasets, 85%+ ML accuracy, Power BI dashboards', 20, y);
                y += 8;
                
                // Education
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('EDUCATION', 20, y);
                doc.line(20, y + 1, 52, y + 1);
                y += 6;
                doc.setFontSize(11);
                doc.text('MCA - Dayananda Sagar Academy | CGPA: 8.0 | 2023-2025', 20, y);
                y += 5;
                doc.text('BCA - RNS College, Bangalore University | CGPA: 7.04 | 2020-2023', 20, y);
                y += 8;
                
                // Skills
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('TECHNICAL SKILLS', 20, y);
                doc.line(20, y + 1, 68, y + 1);
                y += 6;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('Languages: Python, Java, C, SQL, JavaScript', 20, y);
                y += 5;
                doc.text('AI/ML: Machine Learning, OpenCV, scikit-learn, NLP', 20, y);
                y += 5;
                doc.text('Cloud: AWS (EC2, S3), Docker, Git, Linux', 20, y);
                y += 5;
                doc.text('Database: MongoDB, Redis, MySQL', 20, y);
                y += 8;
                
                // Projects
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('KEY PROJECTS', 20, y);
                doc.line(20, y + 1, 58, y + 1);
                y += 6;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('• AI Job Hunter - PyQt5 app with AI-powered job matching', 20, y);
                y += 5;
                doc.text('• Hand-Tracking Keyboard - 95% gesture detection accuracy', 20, y);
                y += 5;
                doc.text('• Amazon Sales Analysis - 91% forecasting accuracy', 20, y);
                y += 8;
                
                // Certifications
                doc.setFontSize(14);
                doc.setFont(undefined, 'bold');
                doc.text('CERTIFICATIONS', 20, y);
                doc.line(20, y + 1, 64, y + 1);
                y += 6;
                doc.setFontSize(10);
                doc.setFont(undefined, 'normal');
                doc.text('AWS Cloud Practitioner • Machine Learning • Google UX Design • Data Analytics', 20, y);
                
                // Footer
                doc.setFontSize(8);
                doc.setTextColor(150, 150, 150);
                doc.text('Generated from karthik77-kk.github.io/karthikm-resume', 105, 285, { align: 'center' });
                
                doc.save('Karthik_M_Resume.pdf');
                
                showNotification('Resume downloaded successfully! 🎉', 'success');
                addXP(50, 'Downloaded resume');
            } catch (error) {
                console.error('Resume error:', error);
                showNotification('Error generating resume. Try again.', 'error');
            }
        }

        // ==================== PROJECT MODAL SYSTEM ====================
        const projectData = {
            'ai-job-hunter': {
                title: '🤖 Enhanced AI Job Hunter',
                problem: 'Job seekers struggle with manually searching through hundreds of job postings, creating tailored resumes for each application, and tracking their application progress across multiple platforms.',
                solution: 'Developed an intelligent desktop application using PyQt5 with Material 3 design that leverages OpenAI GPT-4 API to automatically match candidates with relevant job opportunities, generate customized resumes, and provide comprehensive application tracking with analytics.',
                results: [
                    'Reduced job search time by 70% through AI-powered matching algorithms',
                    'Automated resume generation increased application rates by 3x',
                    'Built-in analytics helped users identify trending skills in their target market',
                    'Material 3 design improved user engagement by 85%'
                ],
                tech: ['Python 3.8+', 'PyQt5', 'OpenAI GPT-4 API', 'SQLite', 'Material Design', 'Threading', 'JSON'],
                features: [
                    'AI-powered job matching based on skills and preferences',
                    'One-click resume generation with multiple templates',
                    'Application tracking dashboard with status updates',
                    'Skill gap analysis and learning recommendations',
                    'Interview preparation with AI-generated questions',
                    'Dark/Light theme support with smooth transitions'
                ],
                lessons: 'This project taught me the importance of asynchronous programming for maintaining responsive UIs while making API calls. I also learned to optimize API usage to reduce costs while maintaining functionality. The biggest challenge was creating an intuitive UX for complex AI features.',
                github: 'https://github.com/Karthik77-kk/ai-job-hunter',
                demo: '#',
                images: [
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%2300ffff" text-anchor="middle">AI Job Hunter Dashboard</text></svg>',
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%23ff00ff" text-anchor="middle">Resume Generator</text></svg>'
                ]
            },
            'job-portal': {
                title: '💼 AI-Driven Job Portal',
                problem: 'Traditional job portals lack intelligent matching, leading to poor candidate-job fit and lengthy hiring processes. Recruiters waste hours manually screening resumes.',
                solution: 'Built a NoSQL-based recruitment platform with MongoDB and Redis caching. Implemented automated resume parsing using NLP and machine learning-based ranking algorithms for real-time job matching.',
                results: [
                    'Reduced manual screening time by 25%',
                    'Improved candidate-job match accuracy by 40%',
                    'Real-time notifications reduced time-to-hire by 30%',
                    'Handled 10,000+ concurrent users with Redis caching'
                ],
                tech: ['MongoDB', 'Redis', 'Python', 'Flask', 'NLP', 'scikit-learn', 'REST API'],
                features: [
                    'Automated resume parsing with NLP',
                    'Real-time job matching algorithms',
                    'Recruiter dashboard with analytics',
                    'Candidate profile scoring system',
                    'Redis-powered session management',
                    'RESTful API for mobile integration'
                ],
                lessons: 'Working with NoSQL databases taught me to think differently about data modeling. The biggest insight was understanding when to use document stores vs relational databases. Redis caching was crucial for performance at scale.',
                github: 'https://github.com/Karthik77-kk/job-portal',
                demo: '#',
                images: [
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%2300ff88" text-anchor="middle">Job Portal Dashboard</text></svg>'
                ]
            },
            'hand-tracking-keyboard': {
                title: '👋 Hand-Tracking Virtual Keyboard',
                problem: 'During the pandemic, public touchscreens posed hygiene risks. People needed a touchless way to interact with digital systems in public spaces like airports, hospitals, and kiosks.',
                solution: 'Built a computer vision system using OpenCV and MediaPipe that detects hand gestures in real-time, allowing users to type on a virtual keyboard without physical contact. Implemented gesture recognition for clicking, hovering, and special characters.',
                results: [
                    'Achieved 95% gesture detection accuracy in real-time',
                    'Reduced physical contact in public systems by 100%',
                    'Processing speed of 30+ FPS on standard hardware',
                    'Successfully deployed in 3 pilot locations'
                ],
                tech: ['Python', 'OpenCV', 'MediaPipe', 'NumPy', 'Threading', 'Computer Vision', 'ML'],
                features: [
                    'Real-time hand landmark detection with 21-point tracking',
                    'Gesture-based typing with hover and click detection',
                    'Customizable virtual keyboard layouts',
                    'Auto-calibration for different lighting conditions',
                    'Multi-language support',
                    'Gesture training mode for improved accuracy'
                ],
                lessons: 'Learned extensively about real-time computer vision optimization and the challenges of creating robust gesture recognition that works in varying lighting conditions. Performance optimization was crucial - moved from 15 FPS to 30+ FPS through algorithmic improvements.',
                github: 'https://github.com/Karthik77-kk/hand-tracking-keyboard',
                demo: '#',
                images: [
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%2300ff88" text-anchor="middle">Hand Tracking Demo</text></svg>'
                ]
            },
            'amazon-sales-analysis': {
                title: '📊 Amazon Sales Data Analysis',
                problem: 'E-commerce businesses need accurate sales forecasting to optimize inventory, plan marketing campaigns, and make data-driven decisions. Manual analysis of large datasets is time-consuming and error-prone.',
                solution: 'Developed a comprehensive data analytics pipeline using Python, Pandas, and scikit-learn to analyze Amazon sales data. Built multiple ML models (Random Forest, ARIMA, XGBoost) to predict future sales trends with high accuracy.',
                results: [
                    '91% accuracy in monthly sales predictions',
                    'Identified seasonal patterns reducing overstock by 30%',
                    'Automated reporting saved 20+ hours weekly',
                    'Discovered top-performing product categories'
                ],
                tech: ['Python', 'Pandas', 'NumPy', 'scikit-learn', 'Matplotlib', 'Seaborn', 'Jupyter', 'XGBoost'],
                features: [
                    'Automated data cleaning and preprocessing pipeline',
                    'Multiple ML models for ensemble predictions',
                    'Interactive visualizations with trend analysis',
                    'Seasonal decomposition and pattern recognition',
                    'Product category performance comparison',
                    'Automated monthly reporting with insights'
                ],
                lessons: 'This project deepened my understanding of time series analysis and ensemble methods. I learned the importance of data quality and feature engineering - spending 60% of time on data preparation resulted in significantly better model performance.',
                github: 'https://github.com/Karthik77-kk/amazon-sales-analysis',
                demo: '#',
                images: [
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%23ffaa00" text-anchor="middle">Sales Dashboard</text></svg>'
                ]
            },
            'rfid-automation': {
                title: '🔐 RFID Door Automation System',
                problem: 'Traditional key-based access systems are prone to security breaches, lost keys, and inefficient access management. Organizations need a modern, trackable access control solution.',
                solution: 'Designed and built an IoT-based access control system using ESP32 microcontroller and RFID technology. Integrated with a web dashboard for real-time monitoring and access log management.',
                results: [
                    'Reduced manual access management by 80%',
                    'Enhanced security with audit trail logging',
                    'Real-time access notifications via IoT',
                    'Cost-effective solution compared to commercial alternatives'
                ],
                tech: ['ESP32', 'RFID RC522', 'C/C++', 'IoT', 'Arduino IDE', 'Web Dashboard', 'MySQL'],
                features: [
                    'RFID card authentication with encryption',
                    'Real-time access logging and monitoring',
                    'Web-based admin dashboard',
                    'Guest access management',
                    'Emergency override system',
                    'Battery backup for power outages'
                ],
                lessons: 'This was my first major IoT project. I learned about embedded systems programming, power management, and the challenges of creating reliable hardware-software integration. Security considerations were paramount in the design.',
                github: 'https://github.com/Karthik77-kk/rfid-door-automation',
                demo: '#',
                images: [
                    'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="400" height="300"><rect fill="%231a1a2e" width="400" height="300"/><text x="50%" y="50%" font-family="Arial" font-size="24" fill="%23ff4444" text-anchor="middle">RFID System</text></svg>'
                ]
            }
        };

        function openProjectModal(projectId) {
            const modal = $('projectModal');
            const data = projectData[projectId];
            
            if (!data) {
                console.error('Project data not found:', projectId);
                return;
            }
            
            // Populate modal content
            $('modalTitle').textContent = data.title;
            $('modalProblem').textContent = data.problem;
            $('modalSolution').textContent = data.solution;
            $('modalLessons').textContent = data.lessons;
            
            // Results list
            const resultsList = $('modalResults');
            resultsList.innerHTML = '';
            data.results.forEach(result => {
                const li = document.createElement('li');
                li.textContent = result;
                resultsList.appendChild(li);
            });
            
            // Tech stack
            const techContainer = $('modalTech');
            techContainer.innerHTML = '';
            data.tech.forEach(tech => {
                const badge = document.createElement('span');
                badge.className = 'tech-badge';
                badge.textContent = tech;
                techContainer.appendChild(badge);
            });
            
            // Features list
            const featuresList = $('modalFeatures');
            featuresList.innerHTML = '';
            data.features.forEach(feature => {
                const li = document.createElement('li');
                li.textContent = feature;
                featuresList.appendChild(li);
            });
            
            // Gallery
            const gallery = $('modalGallery');
            gallery.innerHTML = '';
            data.images.forEach(imgSrc => {
                const img = document.createElement('img');
                img.src = imgSrc;
                img.alt = data.title + ' screenshot';
                img.loading = 'lazy';
                gallery.appendChild(img);
            });
            
            // Links
            $('modalGithub').href = data.github;
            $('modalDemo').href = data.demo;
            if (data.demo === '#') {
                $('modalDemo').style.display = 'none';
            } else {
                $('modalDemo').style.display = 'inline-flex';
            }
            
            // Show modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Track in analytics
            trackEvent('project_modal_open', { project: projectId });
            addXP(10, 'Explored project details');
        }

        function closeProjectModal() {
            const modal = $('projectModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Initialize modal event listeners
        function initProjectModals() {
            const modalClose = $('modalClose');
            const modalBackdrop = $('modalBackdrop');
            
            if (modalClose) {
                modalClose.addEventListener('click', closeProjectModal);
            }
            
            if (modalBackdrop) {
                modalBackdrop.addEventListener('click', closeProjectModal);
            }
            
            // ESC key to close
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeProjectModal();
                }
            });
            
            // Add click handlers to project cards
            document.querySelectorAll('.project-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    // Don't open modal if clicking on a link
                    if (e.target.tagName === 'A' || e.target.closest('a')) return;
                    
                    const projectId = card.dataset.project;
                    if (projectId && projectData[projectId]) {
                        openProjectModal(projectId);
                    }
                });
                
                // Make cards keyboard accessible
                card.setAttribute('tabindex', '0');
                card.setAttribute('role', 'button');
                card.setAttribute('aria-label', 'View project details');
                
                card.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const projectId = card.dataset.project;
                        if (projectId && projectData[projectId]) {
                            openProjectModal(projectId);
                        }
                    }
                });
            });
        }

        // ==================== STATS ANIMATION ====================
        function initStatsAnimation() {
            const statCards = document.querySelectorAll('.stat-card');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const card = entry.target;
                        const valueEl = card.querySelector('.stat-value');
                        if (!valueEl) return;
                        
                        const target = parseInt(valueEl.dataset.target) || 0;
                        let current = 0;
                        const duration = 2000;
                        const increment = target / (duration / 16);
                        
                        const counter = setInterval(() => {
                            current += increment;
                            if (current >= target) {
                                valueEl.textContent = target.toLocaleString();
                                clearInterval(counter);
                            } else {
                                valueEl.textContent = Math.floor(current).toLocaleString();
                            }
                        }, 16);
                        
                        observer.unobserve(card);
                    }
                });
            }, { threshold: 0.5 });
            
            statCards.forEach(card => observer.observe(card));
        }

        // ==================== PROJECT FILTERING ====================
        function initProjectFiltering() {
            const filterButtons = document.querySelectorAll('.filter-tag');
            const projectCards = document.querySelectorAll('.project-card');
            
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Update active state
                    filterButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    const filter = button.dataset.filter;
                    
                    projectCards.forEach(card => {
                        const tags = Array.from(card.querySelectorAll('.tech-badge'))
                            .map(badge => badge.textContent.toLowerCase());
                        
                        const shouldShow = filter === 'all' || 
                            tags.some(tag => tag.toLowerCase().includes(filter.toLowerCase()));
                        
                        if (shouldShow) {
                            card.style.display = 'block';
                            card.classList.add('fade-in');
                        } else {
                            card.style.display = 'none';
                            card.classList.remove('fade-in');
                        }
                    });
                    
                    addXP(5, 'Filtered projects');
                });
            });
        }

        // ==================== GITHUB ACTIVITY FEED ====================
        async function initGitHubFeed() {
            const feedContainer = $('githubFeed');
            if (!feedContainer) return;
            
            try {
                const username = 'Karthik77-kk';
                const response = await fetch(`https://api.github.com/users/${username}/events/public?per_page=10`);
                
                if (!response.ok) throw new Error('GitHub API error');
                
                const events = await response.json();
                
                if (!events || events.length === 0) {
                    feedContainer.innerHTML = '<p style="text-align: center; color: var(--text-muted);">No recent activity found.</p>';
                    return;
                }
                
                feedContainer.innerHTML = '';
                let displayedCount = 0;
                
                events.forEach(event => {
                    if (displayedCount >= 5) return;
                    
                    let activityText = '';
                    let icon = '📝';
                    
                    switch(event.type) {
                        case 'PushEvent':
                            icon = '🚀';
                            const commits = event.payload.commits?.length || 1;
                            activityText = `Pushed ${commits} commit${commits > 1 ? 's' : ''} to <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        case 'CreateEvent':
                            icon = '✨';
                            activityText = `Created ${event.payload.ref_type} in <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        case 'ForkEvent':
                            icon = '🔱';
                            activityText = `Forked <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        case 'WatchEvent':
                            icon = '⭐';
                            activityText = `Starred <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        case 'PullRequestEvent':
                            icon = '🔀';
                            activityText = `${event.payload.action} PR in <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        case 'IssuesEvent':
                            icon = '🐛';
                            activityText = `${event.payload.action} issue in <strong>${event.repo.name.split('/')[1]}</strong>`;
                            break;
                        default:
                            return; // Skip unknown events
                    }
                    
                    if (activityText) {
                        displayedCount++;
                        const activityCard = document.createElement('div');
                        activityCard.className = 'activity-item';
                        activityCard.innerHTML = `
                            <span class="activity-icon">${icon}</span>
                            <div class="activity-content">
                                <p>${activityText}</p>
                                <span class="activity-time">${timeAgo(event.created_at)}</span>
                            </div>
                        `;
                        feedContainer.appendChild(activityCard);
                    }
                });
                
                if (displayedCount === 0) {
                    feedContainer.innerHTML = '<p style="text-align: center; color: var(--text-muted);">No displayable activity found.</p>';
                }
                
            } catch (error) {
                console.warn('GitHub feed error:', error);
                feedContainer.innerHTML = `
                    <p style="text-align: center; color: var(--text-muted);">
                        Unable to load GitHub activity. 
                        <a href="https://github.com/Karthik77-kk" target="_blank" rel="noopener noreferrer" style="color: var(--primary);">
                            View on GitHub →
                        </a>
                    </p>
                `;
            }
        }

        function timeAgo(date) {
            const seconds = Math.floor((new Date() - new Date(date)) / 1000);
            const intervals = {
                year: 31536000,
                month: 2592000,
                week: 604800,
                day: 86400,
                hour: 3600,
                minute: 60
            };
            
            for (const [name, value] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / value);
                if (interval >= 1) {
                    return `${interval} ${name}${interval > 1 ? 's' : ''} ago`;
                }
            }
            return 'Just now';
        }

        // ==================== TESTIMONIALS SLIDER ====================
        function initTestimonialsSlider() {
            const track = $('testimonialTrack');
            const dots = document.querySelectorAll('.slider-dots .dot');
            
            if (!track || dots.length === 0) return;
            
            let currentIndex = 0;
            const cards = track.querySelectorAll('.testimonial-card');
            
            function goToSlide(index) {
                currentIndex = index;
                const offset = index * 100;
                track.scrollTo({
                    left: (track.scrollWidth / cards.length) * index,
                    behavior: 'smooth'
                });
                
                dots.forEach((dot, i) => {
                    dot.classList.toggle('active', i === index);
                });
            }
            
            // Dot click handlers
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => goToSlide(index));
            });
            
            // Auto-rotate testimonials
            setInterval(() => {
                currentIndex = (currentIndex + 1) % cards.length;
                goToSlide(currentIndex);
            }, 6000);
            
            // Detect scroll and update dots
            track.addEventListener('scroll', () => {
                const scrollPosition = track.scrollLeft;
                const cardWidth = track.scrollWidth / cards.length;
                const newIndex = Math.round(scrollPosition / cardWidth);
                
                if (newIndex !== currentIndex) {
                    currentIndex = newIndex;
                    dots.forEach((dot, i) => {
                        dot.classList.toggle('active', i === currentIndex);
                    });
                }
            });
        }

        // ==================== COOKIE CONSENT ====================
        function initCookieConsent() {
            const consentStatus = safeGetItem('cookieConsent', null);
            
            // If already consented, don't show banner
            if (consentStatus) return;
            
            // Create cookie consent banner
            const banner = document.createElement('div');
            banner.id = 'cookieConsent';
            banner.className = 'cookie-consent';
            banner.innerHTML = `
                <div class="cookie-content">
                    <p>
                        🍪 This site uses cookies to enhance your experience and for analytics. 
                        <a href="#" onclick="showNotification('We only use essential cookies for functionality and analytics.', 'info'); return false;">Learn more</a>
                    </p>
                    <div class="cookie-actions">
                        <button id="acceptCookies" class="btn btn-primary btn-sm">Accept</button>
                        <button id="rejectCookies" class="btn btn-secondary btn-sm">Reject</button>
                    </div>
                </div>
            `;
            document.body.appendChild(banner);
            
            // Show after a short delay
            setTimeout(() => banner.classList.add('show'), 2000);
            
            // Accept handler
            document.getElementById('acceptCookies').addEventListener('click', () => {
                safeSetItem('cookieConsent', 'accepted');
                banner.classList.remove('show');
                setTimeout(() => banner.remove(), 400);
                showNotification('Preferences saved! Thanks for accepting cookies. 🍪', 'success');
                
                // Initialize analytics if available
                if (typeof gtag !== 'undefined') {
                    gtag('consent', 'update', {
                        'analytics_storage': 'granted'
                    });
                }
            });
            
            // Reject handler
            document.getElementById('rejectCookies').addEventListener('click', () => {
                safeSetItem('cookieConsent', 'rejected');
                banner.classList.remove('show');
                setTimeout(() => banner.remove(), 400);
                showNotification('No problem! Only essential features will be used.', 'info');
            });
        }

        // ==================== TYPEWRITER EFFECT ====================
        function initTypewriter() {
            const phrases = [
                '.NET FULL STACK DEVELOPER',
                'C# EXPERT',
                'AZURE CLOUD ARCHITECT',
                'SOFTWARE ENGINEER',
                'ANGULAR DEVELOPER',
                'PROBLEM SOLVER'
            ];
            let phraseIndex = 0;
            let charIndex = 0;
            let isDeleting = false;
            const typewriter = $('typewriter');

            function type() {
                const currentPhrase = phrases[phraseIndex];
                
                if (isDeleting) {
                    typewriter.textContent = currentPhrase.substring(0, charIndex - 1);
                    charIndex--;
                } else {
                    typewriter.textContent = currentPhrase.substring(0, charIndex + 1);
                    charIndex++;
                }

                let typeSpeed = isDeleting ? 50 : 100;

                if (!isDeleting && charIndex === currentPhrase.length) {
                    typeSpeed = 2000;
                    isDeleting = true;
                } else if (isDeleting && charIndex === 0) {
                    isDeleting = false;
                    phraseIndex = (phraseIndex + 1) % phrases.length;
                    typeSpeed = 500;
                }

                setTimeout(type, typeSpeed);
            }

            type();
        }

        // ==================== PORTFOLIO FEATURES ====================
        function initPortfolio() {
            initTypewriter();
            updateXPDisplay();
            initProjectModals(); // Initialize project modals
            initStatsAnimation(); // Animate stats counters
            initProjectFiltering(); // Project filter functionality
            initTestimonialsSlider(); // Testimonials slider
            initGitHubFeed(); // Fetch GitHub activity
            initGitHubStats(); // GitHub stats visualization
            initCookieConsent(); // Cookie consent banner
            
            // Copy email button handler
            const copyEmailBtn = document.querySelector('.copy-email-btn');
            if (copyEmailBtn) {
                copyEmailBtn.addEventListener('click', copyEmail);
            }

            // Theme is locked to dark mode - no toggle functionality
            document.documentElement.setAttribute('data-theme', 'dark');

            // Mobile Menu Toggle
            const mobileMenuBtn = $('mobileMenuBtn');
            const navLinks = $('navLinks');
            mobileMenuBtn.addEventListener('click', () => {
                navLinks.classList.toggle('mobile-open');
            });

            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', () => {
                    navLinks.classList.remove('mobile-open');
                });
            });

            // Create shooting stars periodically
            function createShootingStar() {
                const star = document.createElement('div');
                star.className = 'shooting-star';
                star.style.top = Math.random() * 50 + '%';
                star.style.left = Math.random() * 100 + '%';
                star.style.width = Math.random() * 100 + 50 + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                document.querySelector('.space-bg').appendChild(star);
                setTimeout(() => star.remove(), 3000);
            }
            setInterval(createShootingStar, 2500);

            // Add parallax class to body
            document.body.classList.add('parallax-enabled');

            // Scroll progress bar with parallax
            window.addEventListener('scroll', () => {
                const scrollPercent = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
                $('progressBar').style.width = scrollPercent + '%';

                // Update parallax CSS variable
                document.documentElement.style.setProperty('--scroll-y', window.scrollY);

                // Back to top button
                $('backToTop').classList.toggle('visible', window.scrollY > 500);

                // Update active section
                updateActiveSection();
            });

            // Back to top
            $('backToTop').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                addXP(5, 'Navigation');
            });

            // Section indicator dots
            document.querySelectorAll('.section-dot').forEach(dot => {
                dot.addEventListener('click', () => {
                    const section = document.getElementById(dot.dataset.section);
                    if (section) {
                        section.scrollIntoView({ behavior: 'smooth' });
                        addXP(5, 'Navigation');
                    }
                });
            });

            // Track section visits for achievements
            function updateActiveSection() {
                const sections = ['about', 'skills', 'experience', 'stats', 'projects', 'certifications', 'testimonials', 'github-activity', 'contact'];
                let currentSection = sections[0];

                sections.forEach(sectionId => {
                    const section = document.getElementById(sectionId);
                    if (section) {
                        const rect = section.getBoundingClientRect();
                        if (rect.top <= window.innerHeight / 2 && rect.bottom >= window.innerHeight / 2) {
                            currentSection = sectionId;
                            
                            // Track visited sections
                            if (!state.sectionsVisited.includes(sectionId)) {
                                state.sectionsVisited.push(sectionId);
                                localStorage.setItem('sectionsVisited', JSON.stringify(state.sectionsVisited));
                                addXP(15, `Visited ${sectionId}`);
                                
                                // Check if all sections visited
                                if (state.sectionsVisited.length >= sections.length) {
                                    unlockAchievement('section_all');
                                }
                            }
                        }
                    }
                });

                // Update nav links
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${currentSection}`);
                });

                // Update section dots
                document.querySelectorAll('.section-dot').forEach(dot => {
                    dot.classList.toggle('active', dot.dataset.section === currentSection);
                });
            }

            // Particle effects on mouse move
            const createParticle = (x, y) => {
                if (Math.random() < 0.1 && $('portfolio').classList.contains('visible')) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = x + 'px';
                    particle.style.top = y + 'px';
                    particle.style.background = ['#00ffff', '#ff00ff', '#ffff00'][Math.floor(Math.random() * 3)];
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), 3000);
                }
            };

            document.addEventListener('mousemove', (e) => createParticle(e.clientX, e.clientY));
            document.addEventListener('touchmove', (e) => {
                if (e.touches[0]) createParticle(e.touches[0].clientX, e.touches[0].clientY);
            });

            // Smooth scroll
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        addXP(5, 'Navigation');
                    }
                });
            });

            // Contact form with enhanced validation
            const contactForm = $('contactForm');
            if (contactForm) {
                const nameInput = $('name');
                const emailInput = $('email');
                const messageInput = $('message');
                const submitBtn = $('submitBtn');
                
                // Real-time validation
                function validateField(input, errorId, validator) {
                    const errorEl = $(errorId);
                    const value = input.value.trim();
                    const error = validator(value);
                    
                    if (error) {
                        input.classList.add('error');
                        input.classList.remove('success');
                        errorEl.textContent = error;
                        return false;
                    } else {
                        input.classList.remove('error');
                        input.classList.add('success');
                        errorEl.textContent = '';
                        return true;
                    }
                }
                
                // Validators
                const validators = {
                    name: (val) => !val ? 'Name is required' : val.length < 2 ? 'Name too short' : null,
                    email: (val) => !val ? 'Email is required' : !isValidEmail(val) ? 'Invalid email format' : null,
                    message: (val) => !val ? 'Message is required' : val.length < 10 ? 'Message too short (min 10 chars)' : null
                };
                
                // Add blur validation
                nameInput.addEventListener('blur', () => validateField(nameInput, 'nameError', validators.name));
                emailInput.addEventListener('blur', () => validateField(emailInput, 'emailError', validators.email));
                messageInput.addEventListener('blur', () => validateField(messageInput, 'messageError', validators.message));
                
                contactForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    // Validate all fields
                    const nameValid = validateField(nameInput, 'nameError', validators.name);
                    const emailValid = validateField(emailInput, 'emailError', validators.email);
                    const messageValid = validateField(messageInput, 'messageError', validators.message);
                    
                    if (!nameValid || !emailValid || !messageValid) {
                        showNotification('Please fix the errors in the form', 'error');
                        return;
                    }
                    
                    const originalText = submitBtn.textContent;
                    submitBtn.textContent = '⏳ Sending...';
                    submitBtn.disabled = true;

                    const formData = new FormData(this);
                    const formAction = this.getAttribute('action');
                    
                    // Check if form has valid Formspree action
                    if (formAction && !formAction.includes('YOUR_FORMSPREE_ID')) {
                        // Real submission to Formspree
                        try {
                            const response = await fetch(formAction, {
                                method: 'POST',
                                body: formData,
                                headers: { 'Accept': 'application/json' }
                            });
                            
                            if (response.ok) {
                                submitBtn.textContent = '✅ Message Sent!';
                                this.reset();
                                nameInput.classList.remove('success');
                                emailInput.classList.remove('success');
                                messageInput.classList.remove('success');
                                showNotification('Thanks for reaching out! I\'ll get back to you soon. 🚀', 'success');
                                addXP(50, 'Sent message');
                                
                                // Track in analytics
                                if (typeof gtag !== 'undefined') {
                                    gtag('event', 'form_submission', {
                                        'event_category': 'engagement',
                                        'event_label': 'Contact Form'
                                    });
                                }
                            } else {
                                throw new Error('Form submission failed');
                            }
                        } catch (error) {
                            submitBtn.textContent = '❌ Error - Try Again';
                            showNotification('Oops! Something went wrong. Try WhatsApp or email instead.', 'error');
                            console.error('Form error:', error);
                        } finally {
                            setTimeout(() => {
                                submitBtn.textContent = originalText;
                                submitBtn.disabled = false;
                            }, 3000);
                        }
                    } else {
                        // Fallback: Open email client
                        const subject = encodeURIComponent($('subject').value || 'Portfolio Contact');
                        const body = encodeURIComponent(
                            `Name: ${nameInput.value}\nEmail: ${emailInput.value}\n\nMessage:\n${messageInput.value}`
                        );
                        const mailto = `mailto:iammrkarthik2002@gmail.com?subject=${subject}&body=${body}`;
                        
                        window.location.href = mailto;
                        
                        submitBtn.textContent = '✅ Opening Email Client...';
                        this.reset();
                        showNotification('Email client opening. Alternatively, try WhatsApp!', 'info');
                        addXP(25, 'Used email fallback');
                        
                        setTimeout(() => {
                            submitBtn.textContent = originalText;
                            submitBtn.disabled = false;
                        }, 3000);
                    }
                });
            }

            // Intersection Observer for section animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, observerOptions);

            document.querySelectorAll('section').forEach(section => {
                sectionObserver.observe(section);
            });

            // Timeline items animation
            const timelineObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                    }
                });
            }, { threshold: 0.2 });

            document.querySelectorAll('.timeline-item').forEach(item => {
                timelineObserver.observe(item);
            });

            // Skill bars animation
            const skillObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const bars = entry.target.querySelectorAll('.skill-bar-fill');
                        bars.forEach(bar => {
                            const targetWidth = bar.dataset.level || '80';
                            bar.style.width = targetWidth + '%';
                            bar.classList.add('animated');
                        });
                    }
                });
            }, { threshold: 0.3 });

            document.querySelectorAll('.skill-category').forEach(cat => {
                skillObserver.observe(cat);
            });

            // 3D Tilt effect for project cards
            document.querySelectorAll('.project-card').forEach(card => {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (y - centerY) / 10;
                    const rotateY = (centerX - x) / 10;
                    
                    card.style.transform = `translateY(-15px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                });

                card.addEventListener('mouseleave', () => {
                    card.style.transform = '';
                });

                card.addEventListener('click', () => addXP(5, 'Explored project'));
            });

            // Skill tags XP
            document.querySelectorAll('.skill-tag').forEach(tag => {
                tag.addEventListener('click', () => addXP(3, 'Viewed skill'));
            });

            // Cert cards XP
            document.querySelectorAll('.cert-card').forEach(card => {
                card.addEventListener('click', () => addXP(3, 'Viewed certification'));
            });

            // Magnetic button effect
            document.querySelectorAll('.magnetic-btn').forEach(btn => {
                btn.addEventListener('mousemove', (e) => {
                    const rect = btn.getBoundingClientRect();
                    const x = e.clientX - rect.left - rect.width / 2;
                    const y = e.clientY - rect.top - rect.height / 2;
                    btn.style.transform = `translate(${x * 0.3}px, ${y * 0.3}px)`;
                });

                btn.addEventListener('mouseleave', () => {
                    btn.style.transform = '';
                });
            });
        }

        // ==================== ENTRY CHOICE SCREEN ====================
        function initEntryChoice() {
            const entryChoice = $('entryChoice');
            const rememberCheckbox = $('rememberChoiceCheckbox');
            const savedChoice = safeGetItem('portfolioEntryChoice', null);
            const playGameBtn = $('playGameBtn');
            const viewPortfolioBtn = $('viewPortfolioBtn');
            const resetPreferenceLink = $('resetPreference');
            
            if (savedChoice === 'portfolio') {
                // Auto-skip for returning visitors who chose portfolio
                entryChoice.classList.add('hidden');
                skipToPortfolio();
                showNotification('Welcome back! 👋', 'info', 3000);
                return;
            } else if (savedChoice === 'game') {
                // Auto-start game for returning visitors
                entryChoice.classList.add('hidden');
                return;
            }
            
            // Show choice screen for new visitors
            entryChoice.classList.remove('hidden');
            
            playGameBtn.addEventListener('click', () => {
                if (rememberCheckbox.checked) {
                    safeSetItem('portfolioEntryChoice', 'game');
                }
                entryChoice.classList.add('hidden');
                addXP(10, 'Started game');
            });
            
            viewPortfolioBtn.addEventListener('click', () => {
                if (rememberCheckbox.checked) {
                    safeSetItem('portfolioEntryChoice', 'portfolio');
                }
                entryChoice.classList.add('hidden');
                skipToPortfolio();
            });
            
            if (resetPreferenceLink) {
                resetPreferenceLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    localStorage.removeItem('portfolioEntryChoice');
                    showNotification('Preference reset! Reload to choose again.', 'success');
                });
            }
        }

        // ==================== INITIALIZATION ====================
        window.addEventListener('load', () => {
            setTimeout(() => {
                $('loadingScreen').classList.add('hidden');
                initEntryChoice(); // Initialize entry choice
                
                // Start game in boss mode if selected
                if (state.currentMode === 'boss') {
                    setTimeout(spawnBoss, 1000);
                }
                
                gameLoop();
            }, 2800);
            
            initPortfolio();
        });

        // Responsive canvas
        window.addEventListener('resize', () => {
            resizeCanvas();
            game.player.x = Math.min(game.player.x, canvas.width - game.player.width);
            game.player.y = Math.min(game.player.y, canvas.height - game.player.height);
        });

        // Prevent default touch behaviors
        document.body.addEventListener('touchmove', (e) => {
            if (e.target === canvas) e.preventDefault();
        }, { passive: false });

        // Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW not registered'));
            });
        }
    </script>
    
    <!-- New Feature Scripts -->
    <script src="assets/js/utils.js"></script>
    <script src="assets/js/portfolio.js"></script>
    
    <!-- AI Chatbot & Immersive Effects -->
    <script src="assets/js/ai-chatbot.js"></script>
    <script src="assets/js/immersive-effects.js"></script>
    <script src="assets/js/advanced-features.js"></script>
    <script src="assets/js/ultra-advanced.js"></script>
    <script src="assets/js/futuristic-features.js"></script>
    <script src="assets/js/mega-features.js"></script>
</body>
</html>